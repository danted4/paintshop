(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))o(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const l of i.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&o(l)}).observe(document,{childList:!0,subtree:!0});function n(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function o(a){if(a.ep)return;a.ep=!0;const i=n(a);fetch(a.href,i)}})();var Ee,S,xt,se,rt,St,Pt,It,We,De,Me,Rt,ye={},Et=[],Xt=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,Ne=Array.isArray;function ee(e,t){for(var n in t)e[n]=t[n];return e}function Ue(e){e&&e.parentNode&&e.parentNode.removeChild(e)}function Le(e,t,n){var o,a,i,l={};for(i in t)i=="key"?o=t[i]:i=="ref"?a=t[i]:l[i]=t[i];if(arguments.length>2&&(l.children=arguments.length>3?Ee.call(arguments,2):n),typeof e=="function"&&e.defaultProps!=null)for(i in e.defaultProps)l[i]===void 0&&(l[i]=e.defaultProps[i]);return Se(e,l,o,a,null)}function Se(e,t,n,o,a){var i={type:e,props:t,key:n,ref:o,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:a??++xt,__i:-1,__u:0};return a==null&&S.vnode!=null&&S.vnode(i),i}function le(e){return e.children}function te(e,t){this.props=e,this.context=t}function pe(e,t){if(t==null)return e.__?pe(e.__,e.__i+1):null;for(var n;t<e.__k.length;t++)if((n=e.__k[t])!=null&&n.__e!=null)return n.__e;return typeof e.type=="function"?pe(e):null}function $t(e){var t,n;if((e=e.__)!=null&&e.__c!=null){for(e.__e=e.__c.base=null,t=0;t<e.__k.length;t++)if((n=e.__k[t])!=null&&n.__e!=null){e.__e=e.__c.base=n.__e;break}return $t(e)}}function Ae(e){(!e.__d&&(e.__d=!0)&&se.push(e)&&!Ie.__r++||rt!=S.debounceRendering)&&((rt=S.debounceRendering)||St)(Ie)}function Ie(){for(var e,t,n,o,a,i,l,h=1;se.length;)se.length>h&&se.sort(Pt),e=se.shift(),h=se.length,e.__d&&(n=void 0,a=(o=(t=e).__v).__e,i=[],l=[],t.__P&&((n=ee({},o)).__v=o.__v+1,S.vnode&&S.vnode(n),je(t.__P,n,o,t.__n,t.__P.namespaceURI,32&o.__u?[a]:null,i,a??pe(o),!!(32&o.__u),l),n.__v=o.__v,n.__.__k[n.__i]=n,Dt(i,n,l),n.__e!=a&&$t(n)));Ie.__r=0}function Ft(e,t,n,o,a,i,l,h,u,c,d){var s,p,m,C,b,I,g=o&&o.__k||Et,f=t.length;for(u=Yt(n,t,g,u,f),s=0;s<f;s++)(m=n.__k[s])!=null&&(p=m.__i==-1?ye:g[m.__i]||ye,m.__i=s,I=je(e,m,p,a,i,l,h,u,c,d),C=m.__e,m.ref&&p.ref!=m.ref&&(p.ref&&ze(p.ref,null,m),d.push(m.ref,m.__c||C,m)),b==null&&C!=null&&(b=C),4&m.__u||p.__k===m.__k?u=Tt(m,u,e):typeof m.type=="function"&&I!==void 0?u=I:C&&(u=C.nextSibling),m.__u&=-7);return n.__e=b,u}function Yt(e,t,n,o,a){var i,l,h,u,c,d=n.length,s=d,p=0;for(e.__k=new Array(a),i=0;i<a;i++)(l=t[i])!=null&&typeof l!="boolean"&&typeof l!="function"?(u=i+p,(l=e.__k[i]=typeof l=="string"||typeof l=="number"||typeof l=="bigint"||l.constructor==String?Se(null,l,null,null,null):Ne(l)?Se(le,{children:l},null,null,null):l.constructor==null&&l.__b>0?Se(l.type,l.props,l.key,l.ref?l.ref:null,l.__v):l).__=e,l.__b=e.__b+1,h=null,(c=l.__i=Kt(l,n,u,s))!=-1&&(s--,(h=n[c])&&(h.__u|=2)),h==null||h.__v==null?(c==-1&&(a>d?p--:a<d&&p++),typeof l.type!="function"&&(l.__u|=4)):c!=u&&(c==u-1?p--:c==u+1?p++:(c>u?p--:p++,l.__u|=4))):e.__k[i]=null;if(s)for(i=0;i<d;i++)(h=n[i])!=null&&!(2&h.__u)&&(h.__e==o&&(o=pe(h)),Lt(h,h));return o}function Tt(e,t,n){var o,a;if(typeof e.type=="function"){for(o=e.__k,a=0;o&&a<o.length;a++)o[a]&&(o[a].__=e,t=Tt(o[a],t,n));return t}e.__e!=t&&(t&&e.type&&!n.contains(t)&&(t=pe(e)),n.insertBefore(e.__e,t||null),t=e.__e);do t=t&&t.nextSibling;while(t!=null&&t.nodeType==8);return t}function Re(e,t){return t=t||[],e==null||typeof e=="boolean"||(Ne(e)?e.some(function(n){Re(n,t)}):t.push(e)),t}function Kt(e,t,n,o){var a,i,l,h=e.key,u=e.type,c=t[n],d=c!=null&&(2&c.__u)==0;if(c===null&&e.key==null||d&&h==c.key&&u==c.type)return n;if(o>(d?1:0)){for(a=n-1,i=n+1;a>=0||i<t.length;)if((c=t[l=a>=0?a--:i++])!=null&&!(2&c.__u)&&h==c.key&&u==c.type)return l}return-1}function ot(e,t,n){t[0]=="-"?e.setProperty(t,n??""):e[t]=n==null?"":typeof n!="number"||Xt.test(t)?n:n+"px"}function Ce(e,t,n,o,a){var i,l;e:if(t=="style")if(typeof n=="string")e.style.cssText=n;else{if(typeof o=="string"&&(e.style.cssText=o=""),o)for(t in o)n&&t in n||ot(e.style,t,"");if(n)for(t in n)o&&n[t]==o[t]||ot(e.style,t,n[t])}else if(t[0]=="o"&&t[1]=="n")i=t!=(t=t.replace(It,"$1")),l=t.toLowerCase(),t=l in e||t=="onFocusOut"||t=="onFocusIn"?l.slice(2):t.slice(2),e.l||(e.l={}),e.l[t+i]=n,n?o?n.u=o.u:(n.u=We,e.addEventListener(t,i?Me:De,i)):e.removeEventListener(t,i?Me:De,i);else{if(a=="http://www.w3.org/2000/svg")t=t.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(t!="width"&&t!="height"&&t!="href"&&t!="list"&&t!="form"&&t!="tabIndex"&&t!="download"&&t!="rowSpan"&&t!="colSpan"&&t!="role"&&t!="popover"&&t in e)try{e[t]=n??"";break e}catch{}typeof n=="function"||(n==null||n===!1&&t[4]!="-"?e.removeAttribute(t):e.setAttribute(t,t=="popover"&&n==1?"":n))}}function it(e){return function(t){if(this.l){var n=this.l[t.type+e];if(t.t==null)t.t=We++;else if(t.t<n.u)return;return n(S.event?S.event(t):t)}}}function je(e,t,n,o,a,i,l,h,u,c){var d,s,p,m,C,b,I,g,f,D,T,H,Y,z,q,O,G,A=t.type;if(t.constructor!=null)return null;128&n.__u&&(u=!!(32&n.__u),i=[h=t.__e=n.__e]),(d=S.__b)&&d(t);e:if(typeof A=="function")try{if(g=t.props,f="prototype"in A&&A.prototype.render,D=(d=A.contextType)&&o[d.__c],T=d?D?D.props.value:d.__:o,n.__c?I=(s=t.__c=n.__c).__=s.__E:(f?t.__c=s=new A(g,T):(t.__c=s=new te(g,T),s.constructor=A,s.render=Qt),D&&D.sub(s),s.props=g,s.state||(s.state={}),s.context=T,s.__n=o,p=s.__d=!0,s.__h=[],s._sb=[]),f&&s.__s==null&&(s.__s=s.state),f&&A.getDerivedStateFromProps!=null&&(s.__s==s.state&&(s.__s=ee({},s.__s)),ee(s.__s,A.getDerivedStateFromProps(g,s.__s))),m=s.props,C=s.state,s.__v=t,p)f&&A.getDerivedStateFromProps==null&&s.componentWillMount!=null&&s.componentWillMount(),f&&s.componentDidMount!=null&&s.__h.push(s.componentDidMount);else{if(f&&A.getDerivedStateFromProps==null&&g!==m&&s.componentWillReceiveProps!=null&&s.componentWillReceiveProps(g,T),!s.__e&&s.shouldComponentUpdate!=null&&s.shouldComponentUpdate(g,s.__s,T)===!1||t.__v==n.__v){for(t.__v!=n.__v&&(s.props=g,s.state=s.__s,s.__d=!1),t.__e=n.__e,t.__k=n.__k,t.__k.some(function(Z){Z&&(Z.__=t)}),H=0;H<s._sb.length;H++)s.__h.push(s._sb[H]);s._sb=[],s.__h.length&&l.push(s);break e}s.componentWillUpdate!=null&&s.componentWillUpdate(g,s.__s,T),f&&s.componentDidUpdate!=null&&s.__h.push(function(){s.componentDidUpdate(m,C,b)})}if(s.context=T,s.props=g,s.__P=e,s.__e=!1,Y=S.__r,z=0,f){for(s.state=s.__s,s.__d=!1,Y&&Y(t),d=s.render(s.props,s.state,s.context),q=0;q<s._sb.length;q++)s.__h.push(s._sb[q]);s._sb=[]}else do s.__d=!1,Y&&Y(t),d=s.render(s.props,s.state,s.context),s.state=s.__s;while(s.__d&&++z<25);s.state=s.__s,s.getChildContext!=null&&(o=ee(ee({},o),s.getChildContext())),f&&!p&&s.getSnapshotBeforeUpdate!=null&&(b=s.getSnapshotBeforeUpdate(m,C)),O=d,d!=null&&d.type===le&&d.key==null&&(O=Mt(d.props.children)),h=Ft(e,Ne(O)?O:[O],t,n,o,a,i,l,h,u,c),s.base=t.__e,t.__u&=-161,s.__h.length&&l.push(s),I&&(s.__E=s.__=null)}catch(Z){if(t.__v=null,u||i!=null)if(Z.then){for(t.__u|=u?160:128;h&&h.nodeType==8&&h.nextSibling;)h=h.nextSibling;i[i.indexOf(h)]=null,t.__e=h}else{for(G=i.length;G--;)Ue(i[G]);Oe(t)}else t.__e=n.__e,t.__k=n.__k,Z.then||Oe(t);S.__e(Z,t,n)}else i==null&&t.__v==n.__v?(t.__k=n.__k,t.__e=n.__e):h=t.__e=Jt(n.__e,t,n,o,a,i,l,u,c);return(d=S.diffed)&&d(t),128&t.__u?void 0:h}function Oe(e){e&&e.__c&&(e.__c.__e=!0),e&&e.__k&&e.__k.forEach(Oe)}function Dt(e,t,n){for(var o=0;o<n.length;o++)ze(n[o],n[++o],n[++o]);S.__c&&S.__c(t,e),e.some(function(a){try{e=a.__h,a.__h=[],e.some(function(i){i.call(a)})}catch(i){S.__e(i,a.__v)}})}function Mt(e){return typeof e!="object"||e==null||e.__b&&e.__b>0?e:Ne(e)?e.map(Mt):ee({},e)}function Jt(e,t,n,o,a,i,l,h,u){var c,d,s,p,m,C,b,I=n.props,g=t.props,f=t.type;if(f=="svg"?a="http://www.w3.org/2000/svg":f=="math"?a="http://www.w3.org/1998/Math/MathML":a||(a="http://www.w3.org/1999/xhtml"),i!=null){for(c=0;c<i.length;c++)if((m=i[c])&&"setAttribute"in m==!!f&&(f?m.localName==f:m.nodeType==3)){e=m,i[c]=null;break}}if(e==null){if(f==null)return document.createTextNode(g);e=document.createElementNS(a,f,g.is&&g),h&&(S.__m&&S.__m(t,i),h=!1),i=null}if(f==null)I===g||h&&e.data==g||(e.data=g);else{if(i=i&&Ee.call(e.childNodes),I=n.props||ye,!h&&i!=null)for(I={},c=0;c<e.attributes.length;c++)I[(m=e.attributes[c]).name]=m.value;for(c in I)if(m=I[c],c!="children"){if(c=="dangerouslySetInnerHTML")s=m;else if(!(c in g)){if(c=="value"&&"defaultValue"in g||c=="checked"&&"defaultChecked"in g)continue;Ce(e,c,null,m,a)}}for(c in g)m=g[c],c=="children"?p=m:c=="dangerouslySetInnerHTML"?d=m:c=="value"?C=m:c=="checked"?b=m:h&&typeof m!="function"||I[c]===m||Ce(e,c,m,I[c],a);if(d)h||s&&(d.__html==s.__html||d.__html==e.innerHTML)||(e.innerHTML=d.__html),t.__k=[];else if(s&&(e.innerHTML=""),Ft(t.type=="template"?e.content:e,Ne(p)?p:[p],t,n,o,f=="foreignObject"?"http://www.w3.org/1999/xhtml":a,i,l,i?i[0]:n.__k&&pe(n,0),h,u),i!=null)for(c=i.length;c--;)Ue(i[c]);h||(c="value",f=="progress"&&C==null?e.removeAttribute("value"):C!=null&&(C!==e[c]||f=="progress"&&!C||f=="option"&&C!=I[c])&&Ce(e,c,C,I[c],a),c="checked",b!=null&&b!=e[c]&&Ce(e,c,b,I[c],a))}return e}function ze(e,t,n){try{if(typeof e=="function"){var o=typeof e.__u=="function";o&&e.__u(),o&&t==null||(e.__u=e(t))}else e.current=t}catch(a){S.__e(a,n)}}function Lt(e,t,n){var o,a;if(S.unmount&&S.unmount(e),(o=e.ref)&&(o.current&&o.current!=e.__e||ze(o,null,t)),(o=e.__c)!=null){if(o.componentWillUnmount)try{o.componentWillUnmount()}catch(i){S.__e(i,t)}o.base=o.__P=null}if(o=e.__k)for(a=0;a<o.length;a++)o[a]&&Lt(o[a],t,n||typeof e.type!="function");n||Ue(e.__e),e.__c=e.__=e.__e=void 0}function Qt(e,t,n){return this.constructor(e,n)}function en(e,t,n){var o,a,i,l;t==document&&(t=document.documentElement),S.__&&S.__(e,t),a=(o=!1)?null:t.__k,i=[],l=[],je(t,e=t.__k=Le(le,null,[e]),a||ye,ye,t.namespaceURI,a?null:t.firstChild?Ee.call(t.childNodes):null,i,a?a.__e:t.firstChild,o,l),Dt(i,e,l)}function tn(e){function t(n){var o,a;return this.getChildContext||(o=new Set,(a={})[t.__c]=this,this.getChildContext=function(){return a},this.componentWillUnmount=function(){o=null},this.shouldComponentUpdate=function(i){this.props.value!=i.value&&o.forEach(function(l){l.__e=!0,Ae(l)})},this.sub=function(i){o.add(i);var l=i.componentWillUnmount;i.componentWillUnmount=function(){o&&o.delete(i),l&&l.call(i)}}),n.children}return t.__c="__cC"+Rt++,t.__=e,t.Provider=t.__l=(t.Consumer=function(n,o){return n.children(o)}).contextType=t,t}Ee=Et.slice,S={__e:function(e,t,n,o){for(var a,i,l;t=t.__;)if((a=t.__c)&&!a.__)try{if((i=a.constructor)&&i.getDerivedStateFromError!=null&&(a.setState(i.getDerivedStateFromError(e)),l=a.__d),a.componentDidCatch!=null&&(a.componentDidCatch(e,o||{}),l=a.__d),l)return a.__E=a}catch(h){e=h}throw e}},xt=0,te.prototype.setState=function(e,t){var n;n=this.__s!=null&&this.__s!=this.state?this.__s:this.__s=ee({},this.state),typeof e=="function"&&(e=e(ee({},n),this.props)),e&&ee(n,e),e!=null&&this.__v&&(t&&this._sb.push(t),Ae(this))},te.prototype.forceUpdate=function(e){this.__v&&(this.__e=!0,e&&this.__h.push(e),Ae(this))},te.prototype.render=le,se=[],St=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,Pt=function(e,t){return e.__v.__b-t.__v.__b},Ie.__r=0,It=/(PointerCapture)$|Capture$/i,We=0,De=it(!1),Me=it(!0),Rt=0;var nn=0;function r(e,t,n,o,a,i){t||(t={});var l,h,u=t;if("ref"in u)for(h in u={},t)h=="ref"?l=t[h]:u[h]=t[h];var c={type:e,props:u,key:n,ref:l,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:--nn,__i:-1,__u:0,__source:a,__self:i};if(typeof e=="function"&&(l=e.defaultProps))for(h in l)u[h]===void 0&&(u[h]=l[h]);return S.vnode&&S.vnode(c),c}var ce,M,Fe,at,me=0,At=[],L=S,st=L.__b,lt=L.__r,ct=L.diffed,ht=L.__c,ut=L.unmount,dt=L.__;function ke(e,t){L.__h&&L.__h(M,e,me||t),me=0;var n=M.__H||(M.__H={__:[],__h:[]});return e>=n.__.length&&n.__.push({}),n.__[e]}function P(e){return me=1,rn(Bt,e)}function rn(e,t,n){var o=ke(ce++,2);if(o.t=e,!o.__c&&(o.__=[n?n(t):Bt(void 0,t),function(h){var u=o.__N?o.__N[0]:o.__[0],c=o.t(u,h);u!==c&&(o.__N=[c,o.__[1]],o.__c.setState({}))}],o.__c=M,!M.__f)){var a=function(h,u,c){if(!o.__c.__H)return!0;var d=o.__c.__H.__.filter(function(p){return!!p.__c});if(d.every(function(p){return!p.__N}))return!i||i.call(this,h,u,c);var s=o.__c.props!==h;return d.forEach(function(p){if(p.__N){var m=p.__[0];p.__=p.__N,p.__N=void 0,m!==p.__[0]&&(s=!0)}}),i&&i.call(this,h,u,c)||s};M.__f=!0;var i=M.shouldComponentUpdate,l=M.componentWillUpdate;M.componentWillUpdate=function(h,u,c){if(this.__e){var d=i;i=void 0,a(h,u,c),i=d}l&&l.call(this,h,u,c)},M.shouldComponentUpdate=a}return o.__N||o.__}function he(e,t){var n=ke(ce++,3);!L.__s&&Ge(n.__H,t)&&(n.__=e,n.u=t,M.__H.__h.push(n))}function on(e,t){var n=ke(ce++,4);!L.__s&&Ge(n.__H,t)&&(n.__=e,n.u=t,M.__h.push(n))}function ge(e){return me=5,Ht(function(){return{current:e}},[])}function Ot(e,t,n){me=6,on(function(){if(typeof e=="function"){var o=e(t());return function(){e(null),o&&typeof o=="function"&&o()}}if(e)return e.current=t(),function(){return e.current=null}},n==null?n:n.concat(e))}function Ht(e,t){var n=ke(ce++,7);return Ge(n.__H,t)&&(n.__=e(),n.__H=t,n.__h=e),n.__}function He(e,t){return me=8,Ht(function(){return e},t)}function an(e){var t=M.context[e.__c],n=ke(ce++,9);return n.c=e,t?(n.__==null&&(n.__=!0,t.sub(M)),t.props.value):e.__}function sn(){for(var e;e=At.shift();)if(e.__P&&e.__H)try{e.__H.__h.forEach(Pe),e.__H.__h.forEach(Be),e.__H.__h=[]}catch(t){e.__H.__h=[],L.__e(t,e.__v)}}L.__b=function(e){M=null,st&&st(e)},L.__=function(e,t){e&&t.__k&&t.__k.__m&&(e.__m=t.__k.__m),dt&&dt(e,t)},L.__r=function(e){lt&&lt(e),ce=0;var t=(M=e.__c).__H;t&&(Fe===M?(t.__h=[],M.__h=[],t.__.forEach(function(n){n.__N&&(n.__=n.__N),n.u=n.__N=void 0})):(t.__h.forEach(Pe),t.__h.forEach(Be),t.__h=[],ce=0)),Fe=M},L.diffed=function(e){ct&&ct(e);var t=e.__c;t&&t.__H&&(t.__H.__h.length&&(At.push(t)!==1&&at===L.requestAnimationFrame||((at=L.requestAnimationFrame)||ln)(sn)),t.__H.__.forEach(function(n){n.u&&(n.__H=n.u),n.u=void 0})),Fe=M=null},L.__c=function(e,t){t.some(function(n){try{n.__h.forEach(Pe),n.__h=n.__h.filter(function(o){return!o.__||Be(o)})}catch(o){t.some(function(a){a.__h&&(a.__h=[])}),t=[],L.__e(o,n.__v)}}),ht&&ht(e,t)},L.unmount=function(e){ut&&ut(e);var t,n=e.__c;n&&n.__H&&(n.__H.__.forEach(function(o){try{Pe(o)}catch(a){t=a}}),n.__H=void 0,t&&L.__e(t,n.__v))};var _t=typeof requestAnimationFrame=="function";function ln(e){var t,n=function(){clearTimeout(o),_t&&cancelAnimationFrame(t),setTimeout(e)},o=setTimeout(n,35);_t&&(t=requestAnimationFrame(n))}function Pe(e){var t=M,n=e.__c;typeof n=="function"&&(e.__c=void 0,n()),M=t}function Be(e){var t=M;e.__c=e.__(),M=t}function Ge(e,t){return!e||e.length!==t.length||t.some(function(n,o){return n!==e[o]})}function Bt(e,t){return typeof t=="function"?t(e):t}class we extends Error{constructor(t,n="UNKNOWN_ERROR",o=null){super(t),this.name="AppError",this.code=n,this.details=o,this.timestamp=new Date().toISOString()}}const Wt={FILE_TOO_LARGE:"FILE_TOO_LARGE",UNSUPPORTED_FORMAT:"UNSUPPORTED_FORMAT"},Ze=e=>(t,n="")=>{console.error(`[${n}] Error:`,t);let o="An unexpected error occurred.";t instanceof we?o=t.message:t.name==="QuotaExceededError"?o="Not enough memory available. Try using a smaller image.":t.message.includes("canvas")?o="Canvas operation failed. Please try again.":(t.message.includes("network")||t.message.includes("fetch"))&&(o="Network error. Please check your connection and try again."),e(o)},cn=(e,t)=>async(...n)=>{try{return await e(...n)}catch(o){throw t(o,e.name),o}},hn=(e,t=10*1024*1024)=>{if(e.size>t)throw new we(`File size too large. Maximum size is ${Math.round(t/(1024*1024))}MB.`,Wt.FILE_TOO_LARGE,{fileSize:e.size,maxSize:t})},un=e=>{const t=["image/jpeg","image/jpg","image/png","image/gif","image/webp"];if(!t.includes(e.type))throw new we("Unsupported file format. Please use JPEG, PNG, GIF, or WebP.",Wt.UNSUPPORTED_FORMAT,{fileType:e.type,supportedTypes:t})},dn=(e,t)=>{let n,o=0;return(...a)=>{const i=Date.now();i-o>t?(e(...a),o=i):(clearTimeout(n),n=setTimeout(()=>{e(...a),o=Date.now()},t-(i-o)))}},_n=(e,t)=>{let n;return(...o)=>{clearTimeout(n),n=setTimeout(()=>e(...o),t)}},fn=(e,t=4096,n=4096)=>{if(e.width>t||e.height>n)throw new Error(`Image dimensions too large. Maximum size is ${t}x${n}px`);return!0};function pn({onImageLoad:e,onError:t}){const[n,o]=P(!1),[a,i]=P(!1),l=ge(),h=Ze(t),u=cn(async g=>{try{hn(g),un(g)}catch(f){h(f,"File Validation");return}i(!0);try{const f=await c(g),D=await d(f);fn(D),i(!1),e==null||e(D,g)}catch(f){i(!1),h(f,"Image Loading")}},h),c=g=>new Promise((f,D)=>{const T=new FileReader;T.onload=H=>f(H.target.result),T.onerror=()=>D(new we("Failed to read file. Please try again.")),T.readAsDataURL(g)}),d=g=>new Promise((f,D)=>{const T=new Image;T.onload=()=>f(T),T.onerror=()=>D(new we("Invalid image file. Please try another file.")),T.src=g});return r("div",{className:"image-upload",children:r("div",{className:`upload-area ${n?"drag-over":""} ${a?"loading":""}`,onDragEnter:g=>{g.preventDefault(),o(!0)},onDragOver:g=>{g.preventDefault()},onDragLeave:g=>{g.preventDefault(),g.currentTarget.contains(g.relatedTarget)||o(!1)},onDrop:g=>{g.preventDefault(),o(!1);const f=Array.from(g.dataTransfer.files);f.length>0&&u(f[0])},onClick:()=>{var g;(g=l.current)==null||g.click()},children:[r("input",{ref:l,type:"file",accept:"image/*",onChange:g=>{const f=Array.from(g.target.files);f.length>0&&u(f[0])},style:{display:"none"}}),a?r("div",{className:"loading-indicator",children:[r("div",{className:"spinner"}),r("p",{children:"Loading image..."})]}):r("div",{className:"upload-content",children:[r("div",{className:"upload-icon",children:"📷"}),r("h3",{children:"Upload an Image"}),r("p",{children:"Drag and drop an image here, or click to select"}),r("p",{className:"supported-formats",children:"Supports: JPEG, PNG, GIF, WebP (max 10MB)"})]})]})})}function mn({tool:e,onToolChange:t,brushSize:n,onBrushSizeChange:o,color:a,onColorChange:i,onUndo:l,onRedo:h,onClear:u,canUndo:c,canRedo:d,tools:s}){const p={brush:"🖌️",pencil:"✏️",eraser:"🧽",fill:"🪣",rectangle:"⬜",ellipse:"⭕",line:"📏",text:"📝"},m={brush:"Brush",pencil:"Pencil",eraser:"Eraser",fill:"Fill",rectangle:"Rectangle",ellipse:"Ellipse",line:"Line",text:"Text"},C=["#000000","#FFFFFF","#FF0000","#00FF00","#0000FF","#FFFF00","#FF00FF","#00FFFF","#FFA500","#800080","#FFC0CB","#A52A2A","#808080","#000080","#008000"];return r("div",{className:"toolbar-sidebar",children:[r("div",{className:"tool-grid",children:Object.entries(s).map(([b,I])=>r("button",{className:`tool-btn ${e===I?"active":""}`,onClick:()=>t(I),title:m[I],children:p[I]},b))}),r("div",{className:"control-section",children:[r("label",{className:"control-label",children:["Size: ",n,"px"]}),r("input",{type:"range",min:"1",max:"50",value:n,onChange:b=>o(parseInt(b.target.value)),className:"size-slider"})]}),r("div",{className:"control-section",children:[r("label",{className:"control-label",children:"Color"}),r("div",{className:"color-section",children:[r("input",{type:"color",value:a,onChange:b=>i(b.target.value),className:"color-picker",title:"Custom color"}),r("div",{className:"color-presets",children:C.map(b=>r("button",{className:`color-preset ${a===b?"active":""}`,style:{backgroundColor:b},onClick:()=>i(b),title:b},b))})]})]}),r("div",{className:"control-section",children:r("div",{className:"action-buttons",children:[r("button",{className:"action-btn",onClick:l,disabled:!c,title:"Undo",children:"↶ Undo"}),r("button",{className:"action-btn",onClick:h,disabled:!d,title:"Redo",children:"↷ Redo"}),r("button",{className:"action-btn clear-btn",onClick:u,title:"Clear canvas",children:"🗑️ Clear"})]})})]})}function Ut(e,t){for(var n in t)e[n]=t[n];return e}function ft(e,t){for(var n in e)if(n!=="__source"&&!(n in t))return!0;for(var o in t)if(o!=="__source"&&e[o]!==t[o])return!0;return!1}function pt(e,t){this.props=e,this.context=t}(pt.prototype=new te).isPureReactComponent=!0,pt.prototype.shouldComponentUpdate=function(e,t){return ft(this.props,e)||ft(this.state,t)};var mt=S.__b;S.__b=function(e){e.type&&e.type.__f&&e.ref&&(e.props.ref=e.ref,e.ref=null),mt&&mt(e)};var gn=typeof Symbol<"u"&&Symbol.for&&Symbol.for("react.forward_ref")||3911;function jt(e){function t(n){var o=Ut({},n);return delete o.ref,e(o,n.ref||null)}return t.$$typeof=gn,t.render=t,t.prototype.isReactComponent=t.__f=!0,t.displayName="ForwardRef("+(e.displayName||e.name)+")",t}var vn=S.__e;S.__e=function(e,t,n,o){if(e.then){for(var a,i=t;i=i.__;)if((a=i.__c)&&a.__c)return t.__e==null&&(t.__e=n.__e,t.__k=n.__k),a.__c(e,t)}vn(e,t,n,o)};var gt=S.unmount;function zt(e,t,n){return e&&(e.__c&&e.__c.__H&&(e.__c.__H.__.forEach(function(o){typeof o.__c=="function"&&o.__c()}),e.__c.__H=null),(e=Ut({},e)).__c!=null&&(e.__c.__P===n&&(e.__c.__P=t),e.__c.__e=!0,e.__c=null),e.__k=e.__k&&e.__k.map(function(o){return zt(o,t,n)})),e}function Gt(e,t,n){return e&&n&&(e.__v=null,e.__k=e.__k&&e.__k.map(function(o){return Gt(o,t,n)}),e.__c&&e.__c.__P===t&&(e.__e&&n.appendChild(e.__e),e.__c.__e=!0,e.__c.__P=n)),e}function Te(){this.__u=0,this.o=null,this.__b=null}function Zt(e){var t=e.__.__c;return t&&t.__a&&t.__a(e)}function xe(){this.i=null,this.l=null}S.unmount=function(e){var t=e.__c;t&&t.__R&&t.__R(),t&&32&e.__u&&(e.type=null),gt&&gt(e)},(Te.prototype=new te).__c=function(e,t){var n=t.__c,o=this;o.o==null&&(o.o=[]),o.o.push(n);var a=Zt(o.__v),i=!1,l=function(){i||(i=!0,n.__R=null,a?a(h):h())};n.__R=l;var h=function(){if(!--o.__u){if(o.state.__a){var u=o.state.__a;o.__v.__k[0]=Gt(u,u.__c.__P,u.__c.__O)}var c;for(o.setState({__a:o.__b=null});c=o.o.pop();)c.forceUpdate()}};o.__u++||32&t.__u||o.setState({__a:o.__b=o.__v.__k[0]}),e.then(l,l)},Te.prototype.componentWillUnmount=function(){this.o=[]},Te.prototype.render=function(e,t){if(this.__b){if(this.__v.__k){var n=document.createElement("div"),o=this.__v.__k[0].__c;this.__v.__k[0]=zt(this.__b,n,o.__O=o.__P)}this.__b=null}var a=t.__a&&Le(le,null,e.fallback);return a&&(a.__u&=-33),[Le(le,null,t.__a?null:e.children),a]};var vt=function(e,t,n){if(++n[1]===n[0]&&e.l.delete(t),e.props.revealOrder&&(e.props.revealOrder[0]!=="t"||!e.l.size))for(n=e.i;n;){for(;n.length>3;)n.pop()();if(n[1]<n[0])break;e.i=n=n[2]}};(xe.prototype=new te).__a=function(e){var t=this,n=Zt(t.__v),o=t.l.get(e);return o[0]++,function(a){var i=function(){t.props.revealOrder?(o.push(a),vt(t,e,o)):a()};n?n(i):i()}},xe.prototype.render=function(e){this.i=null,this.l=new Map;var t=Re(e.children);e.revealOrder&&e.revealOrder[0]==="b"&&t.reverse();for(var n=t.length;n--;)this.l.set(t[n],this.i=[1,0,this.i]);return e.children},xe.prototype.componentDidUpdate=xe.prototype.componentDidMount=function(){var e=this;this.l.forEach(function(t,n){vt(e,n,t)})};var bn=typeof Symbol<"u"&&Symbol.for&&Symbol.for("react.element")||60103,yn=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|dominant|fill|flood|font|glyph(?!R)|horiz|image(!S)|letter|lighting|marker(?!H|W|U)|overline|paint|pointer|shape|stop|strikethrough|stroke|text(?!L)|transform|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/,wn=/^on(Ani|Tra|Tou|BeforeInp|Compo)/,Nn=/[A-Z0-9]/g,kn=typeof document<"u",Cn=function(e){return(typeof Symbol<"u"&&typeof Symbol()=="symbol"?/fil|che|rad/:/fil|che|ra/).test(e)};te.prototype.isReactComponent={},["componentWillMount","componentWillReceiveProps","componentWillUpdate"].forEach(function(e){Object.defineProperty(te.prototype,e,{configurable:!0,get:function(){return this["UNSAFE_"+e]},set:function(t){Object.defineProperty(this,e,{configurable:!0,writable:!0,value:t})}})});var bt=S.event;function xn(){}function Sn(){return this.cancelBubble}function Pn(){return this.defaultPrevented}S.event=function(e){return bt&&(e=bt(e)),e.persist=xn,e.isPropagationStopped=Sn,e.isDefaultPrevented=Pn,e.nativeEvent=e};var In={enumerable:!1,configurable:!0,get:function(){return this.class}},yt=S.vnode;S.vnode=function(e){typeof e.type=="string"&&function(t){var n=t.props,o=t.type,a={},i=o.indexOf("-")===-1;for(var l in n){var h=n[l];if(!(l==="value"&&"defaultValue"in n&&h==null||kn&&l==="children"&&o==="noscript"||l==="class"||l==="className")){var u=l.toLowerCase();l==="defaultValue"&&"value"in n&&n.value==null?l="value":l==="download"&&h===!0?h="":u==="translate"&&h==="no"?h=!1:u[0]==="o"&&u[1]==="n"?u==="ondoubleclick"?l="ondblclick":u!=="onchange"||o!=="input"&&o!=="textarea"||Cn(n.type)?u==="onfocus"?l="onfocusin":u==="onblur"?l="onfocusout":wn.test(l)&&(l=u):u=l="oninput":i&&yn.test(l)?l=l.replace(Nn,"-$&").toLowerCase():h===null&&(h=void 0),u==="oninput"&&a[l=u]&&(l="oninputCapture"),a[l]=h}}o=="select"&&a.multiple&&Array.isArray(a.value)&&(a.value=Re(n.children).forEach(function(c){c.props.selected=a.value.indexOf(c.props.value)!=-1})),o=="select"&&a.defaultValue!=null&&(a.value=Re(n.children).forEach(function(c){c.props.selected=a.multiple?a.defaultValue.indexOf(c.props.value)!=-1:a.defaultValue==c.props.value})),n.class&&!n.className?(a.class=n.class,Object.defineProperty(a,"className",In)):(n.className&&!n.class||n.class&&n.className)&&(a.class=a.className=n.className),t.props=a}(e),e.$$typeof=bn,yt&&yt(e)};var wt=S.__r;S.__r=function(e){wt&&wt(e),e.__c};var Nt=S.diffed;S.diffed=function(e){Nt&&Nt(e);var t=e.props,n=e.__e;n!=null&&e.type==="textarea"&&"value"in t&&t.value!==n.value&&(n.value=t.value==null?"":t.value)};const Rn=jt(function({image:t,onCanvasUpdate:n,onError:o,canvasSize:a={width:800,height:600},tool:i="brush",brushSize:l=5,color:h="#000000",zoom:u=1,onUndoRedoUpdate:c},d){Ot(d,()=>({undo:U,redo:j,clearCanvas:ve}));const s=ge(),[p,m]=P(!1),[C,b]=P([]),[I,g]=P([]),[f,D]=P(null),[T,H]=P(null),[Y,z]=P(!1),[q,O]=P(""),[G,A]=P(null),Z=Ze(o);he(()=>{if(s.current){const v=s.current,w=v.getContext("2d");t?(v.width=t.width,v.height=t.height,w.clearRect(0,0,v.width,v.height),w.drawImage(t,0,0)):(v.width=a.width,v.height=a.height,w.clearRect(0,0,v.width,v.height),w.fillStyle="#ffffff",w.fillRect(0,0,v.width,v.height)),J()}},[t,a]);const J=()=>{const v=s.current;if(v){const w=v.toDataURL(),R=[...C,w].slice(-20);b(R),g([]),n==null||n(v),c==null||c(R,[])}},U=()=>{if(C.length>1){const v=s.current,w=v.getContext("2d"),R=C[C.length-1],x=C[C.length-2],F=[...I,R],_=C.slice(0,-1);g(F),b(_),c==null||c(_,F);const y=new window.Image;y.onload=()=>{w.clearRect(0,0,v.width,v.height),w.drawImage(y,0,0),n==null||n(v)},y.src=x}},j=()=>{if(I.length>0){const v=s.current,w=v.getContext("2d"),R=I[I.length-1],x=[...C,R],F=I.slice(0,-1);b(x),g(F),c==null||c(x,F);const _=new window.Image;_.onload=()=>{w.clearRect(0,0,v.width,v.height),w.drawImage(_,0,0),n==null||n(v)},_.src=R}},ne=v=>{const R=s.current.getBoundingClientRect();return{x:(v.clientX-R.left)/u,y:(v.clientY-R.top)/u}},oe=(v,w,R,x,F)=>{const _=v.getImageData(0,0,v.canvas.width,v.canvas.height),y=_.data,E=[[Math.floor(w),Math.floor(R)]],N=new Set,$=B=>{const V=y[B],ae=y[B+1],K=y[B+2],$e=y[B+3];return V===F.r&&ae===F.g&&K===F.b&&$e===F.a},X=parseInt(x.substr(1,2),16),be=parseInt(x.substr(3,2),16),ie=parseInt(x.substr(5,2),16);for(;E.length>0;){const[B,V]=E.pop(),ae=`${B},${V}`;if(N.has(ae)||B<0||B>=v.canvas.width||V<0||V>=v.canvas.height)continue;N.add(ae);const K=(V*v.canvas.width+B)*4;$(K)&&(y[K]=X,y[K+1]=be,y[K+2]=ie,y[K+3]=255,E.push([B+1,V],[B-1,V],[B,V+1],[B,V-1]))}v.putImageData(_,0,0)},Q=v=>{if(Y)return;const w=ne(v);m(!0),D(w);const R=s.current,x=R.getContext("2d");if(i==="fill"){const F=x.getImageData(w.x,w.y,1,1),_={r:F.data[0],g:F.data[1],b:F.data[2],a:F.data[3]};oe(x,w.x,w.y,h,_),J(),m(!1);return}if(i==="text"){A(w),z(!0),m(!1);return}if(["rectangle","ellipse","line"].includes(i)){const F=document.createElement("canvas");F.width=R.width,F.height=R.height,F.getContext("2d").drawImage(R,0,0),H(F);return}x.globalCompositeOperation=i==="eraser"?"destination-out":"source-over",x.strokeStyle=i==="eraser"?"rgba(0,0,0,1)":h,x.lineWidth=l,x.lineCap="round",x.lineJoin="round",i==="pencil"?x.globalAlpha=1:x.globalAlpha=i==="eraser"?1:.8,x.beginPath(),x.moveTo(w.x,w.y)},re=He(v=>{if(p)try{const w=ne(v),R=s.current,x=R.getContext("2d");if(["rectangle","ellipse","line"].includes(i)){if(x.clearRect(0,0,R.width,R.height),x.drawImage(T,0,0),x.strokeStyle=h,x.lineWidth=l,x.globalCompositeOperation="source-over",i==="rectangle"){const F=w.x-f.x,_=w.y-f.y;x.strokeRect(f.x,f.y,F,_)}else if(i==="ellipse"){const F=Math.abs(w.x-f.x),_=Math.abs(w.y-f.y),y=(f.x+w.x)/2,E=(f.y+w.y)/2;x.beginPath(),x.ellipse(y,E,F,_,0,0,2*Math.PI),x.stroke()}else i==="line"&&(x.beginPath(),x.moveTo(f.x,f.y),x.lineTo(w.x,w.y),x.stroke());return}["brush","pencil","eraser"].includes(i)&&(x.lineTo(w.x,w.y),x.stroke())}catch(w){Z(w,"Drawing")}},[p,i,h,l,f,T]),ue=He(dn(re,16),[re]),de=()=>{p&&(m(!1),H(null),J())},ve=()=>{const v=s.current,w=v.getContext("2d");t?(w.clearRect(0,0,v.width,v.height),w.drawImage(t,0,0)):w.clearRect(0,0,v.width,v.height),J()},_e=v=>{if(!v.trim()||!G)return;const R=s.current.getContext("2d");R.globalCompositeOperation="source-over",R.fillStyle=h,R.font=`${l*4}px Arial, sans-serif`,R.textBaseline="top",R.fillText(v,G.x,G.y),z(!1),O(""),A(null),J()},fe=()=>{z(!1),O(""),A(null)};return r("div",{className:"paint-canvas",children:r("div",{className:"canvas-container",children:r("div",{className:"canvas-wrapper",children:[r("canvas",{ref:s,onMouseDown:Q,onMouseMove:ue,onMouseUp:de,onMouseLeave:de,className:"paint-canvas-element",style:{transform:`scale(${u})`,transformOrigin:"top left"}}),Y&&r("div",{className:"text-input-overlay",style:{position:"absolute",left:`${G.x*u}px`,top:`${G.y*u}px`,transform:`scale(${u})`,transformOrigin:"top left"},children:r("input",{type:"text",value:q,onChange:v=>O(v.target.value),onKeyDown:v=>{v.key==="Enter"?_e(q):v.key==="Escape"&&fe()},onBlur:()=>{setTimeout(()=>{q.trim()?_e(q):fe()},10)},autoFocus:!0,placeholder:"Type your text...",style:{fontSize:`${l*4}px`,color:h,background:"transparent",border:"2px dashed #999",outline:"none",padding:"2px",fontFamily:"Arial, sans-serif",minWidth:"100px"}})})]})})})}),En=jt(({image:e,onCanvasUpdate:t,onError:n,canvasSize:o={width:800,height:600},zoom:a=1,controls:i,setControls:l,onResetFilters:h,onRotateImage:u,onFlipImage:c,onScale:d,onApplyCrop:s,onCancelCrop:p,onUndo:m,onRedo:C,crop:b,setCrop:I,isDragging:g,setIsDragging:f,dragStart:D,setDragStart:T,rotation:H,setRotation:Y,scale:z,setScale:q,undoStack:O,setUndoStack:G,redoStack:A,setRedoStack:Z},J)=>{Ot(J,()=>({flipImage:_e,applyCrop:R,undo:x,redo:F}));const U=ge(),j=ge(),ne=Ze(n);he(()=>{if(U.current){const _=U.current,y=_.getContext("2d");e?(_.width=e.width,_.height=e.height,j.current=e,y.clearRect(0,0,_.width,_.height),y.drawImage(e,0,0)):(_.width=o.width,_.height=o.height,y.clearRect(0,0,_.width,_.height),y.fillStyle="#ffffff",y.fillRect(0,0,_.width,_.height),j.current=null),Q()}},[e,o]);const oe=He(_n(()=>{try{re()}catch(_){ne(_,"Filter Application")}},100),[i,H,z]);he(()=>{oe()},[i,H,z,oe]);const Q=()=>{const _=U.current;if(_){const y=_.toDataURL();G(E=>[...E,y].slice(-20)),Z([]),t==null||t(_)}},re=()=>{if(!U.current)return;const _=U.current,y=_.getContext("2d");if(y.clearRect(0,0,_.width,_.height),!j.current){y.fillStyle="#ffffff",y.fillRect(0,0,_.width,_.height);return}if(y.save(),H!==0||z!==1){const N=_.width/2,$=_.height/2;y.translate(N,$),y.rotate(H*Math.PI/180),y.scale(z,z),y.translate(-N,-$)}const E=[`brightness(${i.brightness}%)`,`contrast(${i.contrast}%)`,`saturate(${i.saturation}%)`,`blur(${i.blur}px)`,`hue-rotate(${i.hue}deg)`].join(" ");y.filter=E,y.drawImage(j.current,0,0),y.restore(),y.filter="none"},ue=_=>fe(_),de=_=>v(_),ve=()=>w(),_e=_=>{const y=U.current;if(y.getContext("2d"),!j.current)return;const E=document.createElement("canvas");E.width=y.width,E.height=y.height;const N=E.getContext("2d");N.save(),_==="horizontal"?(N.translate(E.width,0),N.scale(-1,1)):(N.translate(0,E.height),N.scale(1,-1)),N.drawImage(j.current,0,0),N.restore();const $=new window.Image;$.onload=()=>{j.current=$,re(),Q()},$.src=E.toDataURL()},fe=_=>{const E=U.current.getBoundingClientRect(),N=(_.clientX-E.left)/a,$=(_.clientY-E.top)/a;f(!0),T({x:N,y:$}),I({x:N,y:$,width:0,height:0,active:!0})},v=_=>{if(!g)return;const E=U.current.getBoundingClientRect(),N=(_.clientX-E.left)/a,$=(_.clientY-E.top)/a;I(X=>({...X,width:N-D.x,height:$-D.y}))},w=()=>{if(f(!1),Math.abs(b.width)<10||Math.abs(b.height)<10){I(_=>({..._,active:!1}));return}},R=()=>{if(!b.active)return;const _=U.current,y=_.getContext("2d"),E=Math.min(b.x,b.x+b.width),N=Math.min(b.y,b.y+b.height),$=Math.abs(b.width),X=Math.abs(b.height),be=y.getImageData(E,N,$,X);_.width=$,_.height=X,y.putImageData(be,0,0);const ie=new Image;ie.onload=()=>{j.current=ie,I(B=>({...B,active:!1})),Q()},ie.src=_.toDataURL()},x=()=>{if(O.length>1){const _=U.current,y=_.getContext("2d"),E=O[O.length-1],N=O[O.length-2];Z(X=>[...X,E]),G(X=>X.slice(0,-1));const $=new Image;$.onload=()=>{_.width=$.width,_.height=$.height,y.clearRect(0,0,_.width,_.height),y.drawImage($,0,0),j.current=$,t==null||t(_)},$.src=N}},F=()=>{if(A.length>0){const _=U.current,y=_.getContext("2d"),E=A[A.length-1];G($=>[...$,E]),Z($=>$.slice(0,-1));const N=new Image;N.onload=()=>{_.width=N.width,_.height=N.height,y.clearRect(0,0,_.width,_.height),y.drawImage(N,0,0),j.current=N,t==null||t(_)},N.src=E}};return r("div",{className:"photo-editor",children:[!e&&r("div",{className:"no-image-message",children:r("p",{children:"📷 Load an image to use photo editing features"})}),e&&r("div",{className:"canvas-container",children:r("div",{className:"canvas-wrapper",style:{transform:`scale(${a})`,transformOrigin:"top left"},children:[r("canvas",{ref:U,onMouseDown:ue,onMouseMove:de,onMouseUp:ve,className:"photo-canvas"}),b.active&&r("div",{className:"crop-overlay",style:{left:`${Math.min(b.x,b.x+b.width)}px`,top:`${Math.min(b.y,b.y+b.height)}px`,width:`${Math.abs(b.width)}px`,height:`${Math.abs(b.height)}px`}})]})})]})}),$n=({controls:e,setControls:t,onResetFilters:n,onRotateImage:o,onFlipImage:a,onScale:i,onApplyCrop:l,onCancelCrop:h,onUndo:u,onRedo:c,crop:d})=>r("div",{className:"photo-controls-panel sidebar-photo-controls",children:[r("div",{className:"filter-controls",children:[r("label",{children:["Brightness",r("input",{type:"range",min:"0",max:"200",value:e.brightness,onInput:s=>t(p=>({...p,brightness:parseInt(s.target.value)}))})]}),r("label",{children:["Contrast",r("input",{type:"range",min:"0",max:"200",value:e.contrast,onInput:s=>t(p=>({...p,contrast:parseInt(s.target.value)}))})]}),r("label",{children:["Saturation",r("input",{type:"range",min:"0",max:"200",value:e.saturation,onInput:s=>t(p=>({...p,saturation:parseInt(s.target.value)}))})]}),r("label",{children:["Blur",r("input",{type:"range",min:"0",max:"20",value:e.blur,onInput:s=>t(p=>({...p,blur:parseInt(s.target.value)}))})]}),r("label",{children:["Hue",r("input",{type:"range",min:"-180",max:"180",value:e.hue,onInput:s=>t(p=>({...p,hue:parseInt(s.target.value)}))})]}),r("button",{onClick:()=>t({brightness:100,contrast:100,saturation:100,blur:0,hue:0}),children:"Reset Filters"})]}),r("div",{className:"transform-controls",children:[r("button",{onClick:()=>o(90),children:"Rotate +90°"}),r("button",{onClick:()=>o(-90),children:"Rotate -90°"}),r("button",{onClick:()=>a("horizontal"),children:"Flip Horizontal"}),r("button",{onClick:()=>a("vertical"),children:"Flip Vertical"}),r("button",{onClick:()=>i("out"),children:"Scale -"}),r("button",{onClick:()=>i("in"),children:"Scale +"})]}),r("div",{className:"crop-controls",children:[r("button",{onClick:l,disabled:!d.active,children:"Apply Crop"}),r("button",{onClick:h,disabled:!d.active,children:"Cancel Crop"})]}),r("div",{className:"history-controls",children:[r("button",{onClick:u,children:"Undo"}),r("button",{onClick:c,children:"Redo"})]})]});function kt({canvas:e,filename:t="paintshop-image"}){const[n,o]=P(!1),[a,i]=P(!1),l=async(u="png",c=1)=>{if(e){o(!0);try{const d=document.createElement("canvas"),s=d.getContext("2d");d.width=e.width,d.height=e.height,u==="jpeg"&&(s.fillStyle="#FFFFFF",s.fillRect(0,0,d.width,d.height)),s.drawImage(e,0,0),d.toBlob(p=>{if(p){const m=URL.createObjectURL(p),C=document.createElement("a");C.href=m,C.download=`${t}.${u}`,document.body.appendChild(C),C.click(),document.body.removeChild(C),URL.revokeObjectURL(m)}o(!1),i(!1)},`image/${u}`,c)}catch(d){console.error("Export failed:",d),o(!1)}}},h=()=>{e&&i(!a)};return e?r("div",{className:"export-container",children:[r("button",{className:"icon-btn",onClick:h,disabled:n,children:[n?r("span",{className:"spinner-small"}):r(le,{children:"💾"}),r("div",{className:"tooltip",children:"Export Image"})]}),a&&r("div",{className:"export-formats",children:[r("div",{className:"formats-header",children:[r("h3",{children:"Choose Format"}),r("button",{className:"close-btn",onClick:()=>i(!1),children:"✕"})]}),r("div",{className:"format-options",children:[r("button",{className:"format-btn",onClick:()=>l("png"),title:"Best for images with transparency",children:[r("span",{className:"format-icon",children:"🖼️"}),r("div",{className:"format-info",children:[r("strong",{children:"PNG"}),r("small",{children:"Lossless, supports transparency"})]})]}),r("button",{className:"format-btn",onClick:()=>l("jpeg",.9),title:"Smaller file size, good for photos",children:[r("span",{className:"format-icon",children:"📷"}),r("div",{className:"format-info",children:[r("strong",{children:"JPEG"}),r("small",{children:"Smaller size, good for photos"})]})]}),r("button",{className:"format-btn",onClick:()=>l("webp",.9),title:"Modern format, best compression",children:[r("span",{className:"format-icon",children:"🚀"}),r("div",{className:"format-info",children:[r("strong",{children:"WebP"}),r("small",{children:"Modern format, best compression"})]})]})]})]})]}):r("button",{className:"icon-btn",disabled:!0,children:["💾",r("div",{className:"tooltip",children:"No image to export"})]})}function Fn({onCreateCanvas:e,onCancel:t,currentSize:n}){const[o,a]=P(n.width),[i,l]=P(n.height),h=[{name:"Small (400×300)",width:400,height:300},{name:"Medium (800×600)",width:800,height:600},{name:"Large (1200×800)",width:1200,height:800},{name:"HD (1920×1080)",width:1920,height:1080},{name:"Square Small (400×400)",width:400,height:400},{name:"Square Large (800×800)",width:800,height:800},{name:"Portrait (600×800)",width:600,height:800},{name:"Landscape (1000×600)",width:1e3,height:600}],u=d=>{a(d.width),l(d.height)},c=()=>{o>0&&i>0&&o<=4e3&&i<=4e3&&e({width:parseInt(o),height:parseInt(i)})};return r("div",{className:"canvas-settings",children:r("div",{className:"settings-modal",children:[r("div",{className:"settings-header",children:[r("h2",{children:"New Canvas"}),r("button",{className:"close-btn",onClick:t,children:"✕"})]}),r("div",{className:"settings-content",children:[r("div",{className:"presets-section",children:[r("h3",{children:"Presets"}),r("div",{className:"presets-grid",children:h.map((d,s)=>r("button",{className:`preset-btn ${o===d.width&&i===d.height?"active":""}`,onClick:()=>u(d),children:d.name},s))})]}),r("div",{className:"custom-section",children:[r("h3",{children:"Custom Size"}),r("div",{className:"size-inputs",children:[r("div",{className:"input-group",children:[r("label",{children:"Width (px)"}),r("input",{type:"number",min:"1",max:"4000",value:o,onChange:d=>a(d.target.value)})]}),r("div",{className:"input-group",children:[r("label",{children:"Height (px)"}),r("input",{type:"number",min:"1",max:"4000",value:i,onChange:d=>l(d.target.value)})]})]}),r("p",{className:"size-info",children:["Canvas size: ",o," × ",i," pixels",(o>2e3||i>2e3)&&r("span",{className:"warning",children:" (Large canvas may affect performance)"})]})]})]}),r("div",{className:"settings-actions",children:[r("button",{className:"cancel-btn",onClick:t,children:"Cancel"}),r("button",{className:"create-btn",onClick:c,disabled:!o||!i||o<=0||i<=0||o>4e3||i>4e3,children:"Create Canvas"})]})]})})}function Tn({onClose:e}){return r("div",{className:"help-modal",children:r("div",{className:"help-content",children:[r("div",{className:"help-header",children:[r("h2",{children:"PaintShop Help"}),r("button",{className:"close-btn",onClick:e,children:"✕"})]}),r("div",{className:"help-body",children:[r("section",{className:"help-section",children:[r("h3",{children:"Getting Started"}),r("ul",{children:[r("li",{children:"Start drawing immediately on the blank canvas"}),r("li",{children:"Load an image to edit or draw over it"}),r("li",{children:"Switch between Paint and Photo Edit modes"}),r("li",{children:"Export your work when finished"})]})]}),r("section",{className:"help-section",children:[r("h3",{children:"Paint Mode"}),r("ul",{children:[r("li",{children:"Use various tools: brush, pencil, eraser, shapes"}),r("li",{children:"Adjust brush size and color"}),r("li",{children:"Fill areas with the bucket tool"}),r("li",{children:"Undo/redo your actions"})]})]}),r("section",{className:"help-section",children:[r("h3",{children:"Photo Edit Mode"}),r("ul",{children:[r("li",{children:"Adjust brightness, contrast, saturation"}),r("li",{children:"Apply blur and hue rotation effects"}),r("li",{children:"Rotate and scale images"}),r("li",{children:"Crop images by dragging on canvas"})]})]}),r("section",{className:"help-section",children:[r("h3",{children:"Keyboard Shortcuts"}),r("div",{className:"shortcuts-grid",children:[{key:"Ctrl/Cmd + N",action:"New Canvas"},{key:"Ctrl/Cmd + O",action:"Load Image"},{key:"Ctrl/Cmd + S",action:"Export Canvas"},{key:"Ctrl/Cmd + Z",action:"Undo (in canvas)"},{key:"Ctrl/Cmd + Y",action:"Redo (in canvas)"},{key:"Escape",action:"Close modals"},{key:"1-8",action:"Select paint tools"},{key:"[/]",action:"Decrease/Increase brush size"}].map((n,o)=>r("div",{className:"shortcut-item",children:[r("kbd",{children:n.key}),r("span",{children:n.action})]},o))})]})]}),r("div",{className:"help-footer",children:r("button",{className:"close-btn-primary",onClick:e,children:"Got it!"})})]})})}function Dn({tool:e,onToolChange:t,brushSize:n,onBrushSizeChange:o,color:a,onColorChange:i,onUndo:l,onRedo:h,onClear:u,canUndo:c,canRedo:d,tools:s}){return r(mn,{tool:e,onToolChange:t,brushSize:n,onBrushSizeChange:o,color:a,onColorChange:i,onUndo:l,onRedo:h,onClear:u,canUndo:c,canRedo:d,tools:s})}const Vt=tn(),Mn=()=>{const e=an(Vt);if(!e)throw new Error("useTheme must be used within a ThemeProvider");return e},Ln=({children:e})=>{const[t,n]=P(()=>{const u=localStorage.getItem("paintshop-theme");return u&&["light","dark","system"].includes(u)?u:"system"}),[o,a]=P("light"),i=()=>window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light";he(()=>{const u=()=>{const s=t==="system"?i():t;a(s),document.documentElement.classList.remove("light","dark"),document.documentElement.classList.add(s),document.documentElement.setAttribute("data-theme",s)};u();const c=window.matchMedia("(prefers-color-scheme: dark)"),d=()=>{t==="system"&&u()};return c.addEventListener("change",d),()=>c.removeEventListener("change",d)},[t]),he(()=>{localStorage.setItem("paintshop-theme",t)},[t]);const l=u=>{["light","dark","system"].includes(u)&&n(u)},h={theme:t,resolvedTheme:o,setTheme:l,toggleTheme:()=>{l(o==="light"?"dark":"light")}};return r(Vt.Provider,{value:h,children:e})};function Ct({mobileMode:e=!1}){const{theme:t,resolvedTheme:n,setTheme:o}=Mn();return r("div",{className:"theme-toggle",children:[r("select",{value:t,onChange:i=>{o(i.target.value)},className:"theme-select",title:"Theme selection",children:[r("option",{value:"system",children:e?"🌓":"🌓 System"}),r("option",{value:"light",children:e?"☀️":"☀️ Light"}),r("option",{value:"dark",children:e?"🌙":"🌙 Dark"})]}),r("div",{className:"tooltip",children:["Theme: ",t==="system"?`System (${n})`:t]})]})}function An({isOpen:e,onToggle:t}){return r("button",{className:`hamburger-menu ${e?"open":""}`,onClick:t,"aria-label":"Toggle sidebar menu",children:[r("span",{className:"hamburger-line"}),r("span",{className:"hamburger-line"}),r("span",{className:"hamburger-line"})]})}function On(){const e=ge(),[t,n]=P(null),[o,a]=P("paint"),[i,l]=P(null),[h,u]=P(null),[c,d]=P(!1),[s,p]=P(!1),[m,C]=P(!1),[b,I]=P({width:800,height:600}),[g,f]=P(!1),[D,T]=P(!1),[H,Y]=P("brush"),[z,q]=P(5),[O,G]=P("#000000"),[A,Z]=P([]),[J,U]=P([]),[j,ne]=P(1),[oe,Q]=P({brightness:100,contrast:100,saturation:100,blur:0,hue:0}),[re,ue]=P({x:0,y:0,width:0,height:0,active:!1}),[de,ve]=P(!1),[_e,fe]=P({x:0,y:0}),[v,w]=P(0),[R,x]=P(1),[F,_]=P([]),[y,E]=P([]),N=ge(),$={brush:"brush",pencil:"pencil",eraser:"eraser",fill:"fill",rectangle:"rectangle",ellipse:"ellipse",line:"line",text:"text"},X=()=>{ne(k=>Math.min(k*1.2,5))},be=()=>{ne(k=>Math.max(k/1.2,.1))},ie=()=>{ne(1)},B=(k,W)=>{f(!0),setTimeout(()=>{n(k),u(null),d(!1),I({width:k.width,height:k.height}),f(!1),console.log("Image loaded:",W.name,`${k.width}x${k.height}`)},100)},V=k=>{u(k),setTimeout(()=>u(null),5e3)},ae=k=>{l(k)},K=k=>{a(k)},$e=(k=null)=>{f(!0),setTimeout(()=>{n(null),l(null),a("paint"),d(!1),p(!1),k&&I(k),f(!1)},100)},Ve=()=>{d(!0)},qe=()=>{p(!0)},qt=()=>{T(k=>!k)},Xe=()=>{Q({brightness:100,contrast:100,saturation:100,blur:0,hue:0}),w(0),x(1)},Ye=k=>{w(W=>(W+k+360)%360)},Ke=k=>{N.current&&N.current.flipImage&&N.current.flipImage(k)},Je=k=>{x(W=>k==="in"?Math.min(W*1.2,5):k==="out"?Math.max(W/1.2,.1):W)},Qe=()=>{N.current&&N.current.applyCrop&&N.current.applyCrop()},et=()=>{ue(k=>({...k,active:!1}))},tt=()=>{N.current&&N.current.undo&&N.current.undo()},nt=()=>{N.current&&N.current.redo&&N.current.redo()};return he(()=>{const k=W=>{if(W.ctrlKey||W.metaKey)switch(W.key){case"n":W.preventDefault(),qe();break;case"o":W.preventDefault(),Ve();break;case"s":W.preventDefault();break}W.key==="Escape"&&(D?T(!1):c?d(!1):s?p(!1):m&&C(!1))};return window.addEventListener("keydown",k),()=>window.removeEventListener("keydown",k)},[D,c,s,m]),he(()=>(D&&window.innerWidth<=1024?document.body.style.overflow="hidden":document.body.style.overflow="unset",()=>{document.body.style.overflow="unset"}),[D]),r("div",{className:`app ${D?"sidebar-open":""}`,children:[r(An,{isOpen:D,onToggle:qt}),r("header",{className:"app-header",children:r("div",{className:"header-content",children:[r("div",{className:"header-left",children:[r("div",{className:"app-logo",children:"🎨"}),r("div",{className:"header-title",children:[r("h1",{children:"PaintShop"}),r("p",{children:"Paint & Photo Editor"})]})]}),r("div",{className:"header-right",children:[r(Ct,{}),r("button",{className:"icon-btn",onClick:()=>C(!0),children:["❓",r("div",{className:"tooltip",children:"Help & Shortcuts"})]}),r(kt,{canvas:i})]})]})}),h&&r("div",{className:"error-banner",children:[r("span",{children:["⚠️ ",h]}),r("button",{onClick:()=>u(null),className:"error-close",children:"✕"})]}),r("main",{className:"app-main",children:c?r("div",{className:"welcome-screen",children:[r("div",{className:"upload-header",children:r("button",{className:"back-btn",onClick:()=>d(!1),title:"Back to canvas",children:"← Back to Canvas"})}),r(pn,{onImageLoad:B,onError:V})]}):r("div",{className:"editor-screen",children:[r("div",{className:`editor-sidebar ${D?"open":""}`,children:[r("div",{className:"sidebar-overlay",onClick:()=>T(!1)}),r("div",{className:"sidebar-content",children:[r("div",{className:"sidebar-section mobile-top-controls",children:r("div",{className:"mobile-controls-grid",children:[r("div",{className:"theme-toggle-mobile",children:r(Ct,{mobileMode:!0})}),r("button",{className:"icon-btn mobile-icon-btn",onClick:()=>C(!0),title:"Help & Shortcuts",children:"❓"}),r("div",{className:"mobile-export-wrapper",children:r(kt,{canvas:i})})]})}),r("div",{className:"sidebar-section",children:[r("h3",{children:"Mode"}),r("div",{className:"mode-toggle-compact",children:[r("button",{className:`mode-btn-compact ${o==="paint"?"active":""}`,onClick:()=>K("paint"),children:"🎨 Paint"}),r("button",{className:`mode-btn-compact ${o==="photo"?"active":""}`,onClick:()=>K("photo"),children:"🖼️ Photo"})]})]}),r("div",{className:"sidebar-section",children:[r("h3",{children:"Actions"}),r("div",{className:"action-buttons",children:[r("button",{className:"action-btn load-image-btn",onClick:Ve,title:"Load image from file",children:"📁 Load Image"}),r("button",{className:"action-btn new-canvas-btn",onClick:qe,title:"New blank canvas",children:"📄 New Canvas"})]})]}),r("div",{className:"sidebar-section",children:[r("h3",{children:"View"}),r("div",{className:"zoom-controls",children:[r("div",{className:"zoom-info",children:r("span",{children:["Zoom: ",Math.round(j*100),"%"]})}),r("div",{className:"zoom-buttons",children:[r("button",{className:"action-btn zoom-btn",onClick:be,title:"Zoom out",children:"🔍- Zoom Out"}),r("button",{className:"action-btn zoom-btn",onClick:ie,title:"Reset zoom",children:"🎯 Reset"}),r("button",{className:"action-btn zoom-btn",onClick:X,title:"Zoom in",children:"🔍+ Zoom In"})]})]})]}),o==="paint"&&r("div",{className:"sidebar-section",children:[r("h3",{children:"Tools"}),r(Dn,{tool:H,onToolChange:Y,brushSize:z,onBrushSizeChange:q,color:O,onColorChange:G,onUndo:()=>{var k;return(k=e.current)==null?void 0:k.undo()},onRedo:()=>{var k;return(k=e.current)==null?void 0:k.redo()},onClear:()=>{var k;return(k=e.current)==null?void 0:k.clearCanvas()},canUndo:A.length>1,canRedo:J.length>0,tools:$})]}),o==="photo"&&r("div",{className:"sidebar-section",children:[r("h3",{children:"Adjustments"}),r($n,{controls:oe,setControls:Q,onResetFilters:Xe,onRotateImage:Ye,onFlipImage:Ke,onScale:Je,onApplyCrop:Qe,onCancelCrop:et,onUndo:tt,onRedo:nt,crop:re})]})]})]}),r("div",{className:"editor-container",children:[o==="paint"?r(Rn,{ref:e,image:t,onCanvasUpdate:ae,onError:V,canvasSize:b,tool:H,brushSize:z,color:O,zoom:j,onUndoRedoUpdate:(k,W)=>{Z(k),U(W)}}):null,o==="photo"&&r(En,{ref:N,image:t,onCanvasUpdate:ae,onError:V,canvasSize:b,zoom:j,controls:oe,setControls:Q,onResetFilters:Xe,onRotateImage:Ye,onFlipImage:Ke,onScale:Je,onApplyCrop:Qe,onCancelCrop:et,onUndo:tt,onRedo:nt,crop:re,setCrop:ue,isDragging:de,setIsDragging:ve,dragStart:_e,setDragStart:fe,rotation:v,setRotation:w,scale:R,setScale:x,undoStack:F,setUndoStack:_,redoStack:y,setRedoStack:E})]})]})}),s&&r(Fn,{currentSize:b,onCreateCanvas:$e,onCancel:()=>p(!1)}),m&&r(Tn,{onClose:()=>C(!1)}),g&&r("div",{className:"loading-overlay",children:r("div",{className:"loading-spinner",children:[r("div",{className:"spinner"}),r("p",{children:"Loading..."})]})})]})}en(r(Ln,{children:r(On,{})}),document.getElementById("app"));
