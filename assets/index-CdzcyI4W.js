(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const s of a.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&r(s)}).observe(document,{childList:!0,subtree:!0});function n(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(i){if(i.ep)return;i.ep=!0;const a=n(i);fetch(i.href,a)}})();var xe,C,yt,oe,Qe,wt,Nt,kt,Le,Fe,Ee,fe={},Ct=[],zt=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,me=Array.isArray;function J(e,t){for(var n in t)e[n]=t[n];return e}function Ae(e){e&&e.parentNode&&e.parentNode.removeChild(e)}function $e(e,t,n){var r,i,a,s={};for(a in t)a=="key"?r=t[a]:a=="ref"?i=t[a]:s[a]=t[a];if(arguments.length>2&&(s.children=arguments.length>3?xe.call(arguments,2):n),typeof e=="function"&&e.defaultProps!=null)for(a in e.defaultProps)s[a]===void 0&&(s[a]=e.defaultProps[a]);return ye(e,s,r,i,null)}function ye(e,t,n,r,i){var a={type:e,props:t,key:n,ref:r,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:i??++yt,__i:-1,__u:0};return i==null&&C.vnode!=null&&C.vnode(a),a}function ae(e){return e.children}function Q(e,t){this.props=e,this.context=t}function le(e,t){if(t==null)return e.__?le(e.__,e.__i+1):null;for(var n;t<e.__k.length;t++)if((n=e.__k[t])!=null&&n.__e!=null)return n.__e;return typeof e.type=="function"?le(e):null}function xt(e){var t,n;if((e=e.__)!=null&&e.__c!=null){for(e.__e=e.__c.base=null,t=0;t<e.__k.length;t++)if((n=e.__k[t])!=null&&n.__e!=null){e.__e=e.__c.base=n.__e;break}return xt(e)}}function et(e){(!e.__d&&(e.__d=!0)&&oe.push(e)&&!Ne.__r++||Qe!=C.debounceRendering)&&((Qe=C.debounceRendering)||wt)(Ne)}function Ne(){for(var e,t,n,r,i,a,s,_=1;oe.length;)oe.length>_&&oe.sort(Nt),e=oe.shift(),_=oe.length,e.__d&&(n=void 0,i=(r=(t=e).__v).__e,a=[],s=[],t.__P&&((n=J({},r)).__v=r.__v+1,C.vnode&&C.vnode(n),Oe(t.__P,n,r,t.__n,t.__P.namespaceURI,32&r.__u?[i]:null,a,i??le(r),!!(32&r.__u),s),n.__v=r.__v,n.__.__k[n.__i]=n,It(a,n,s),n.__e!=i&&xt(n)));Ne.__r=0}function St(e,t,n,r,i,a,s,_,h,c,u){var l,p,v,N,b,S,g=r&&r.__k||Ct,f=t.length;for(h=jt(n,t,g,h,f),l=0;l<f;l++)(v=n.__k[l])!=null&&(p=v.__i==-1?fe:g[v.__i]||fe,v.__i=l,S=Oe(e,v,p,i,a,s,_,h,c,u),N=v.__e,v.ref&&p.ref!=v.ref&&(p.ref&&He(p.ref,null,v),u.push(v.ref,v.__c||N,v)),b==null&&N!=null&&(b=N),4&v.__u||p.__k===v.__k?h=Pt(v,h,e):typeof v.type=="function"&&S!==void 0?h=S:N&&(h=N.nextSibling),v.__u&=-7);return n.__e=b,h}function jt(e,t,n,r,i){var a,s,_,h,c,u=n.length,l=u,p=0;for(e.__k=new Array(i),a=0;a<i;a++)(s=t[a])!=null&&typeof s!="boolean"&&typeof s!="function"?(h=a+p,(s=e.__k[a]=typeof s=="string"||typeof s=="number"||typeof s=="bigint"||s.constructor==String?ye(null,s,null,null,null):me(s)?ye(ae,{children:s},null,null,null):s.constructor==null&&s.__b>0?ye(s.type,s.props,s.key,s.ref?s.ref:null,s.__v):s).__=e,s.__b=e.__b+1,_=null,(c=s.__i=Ut(s,n,h,l))!=-1&&(l--,(_=n[c])&&(_.__u|=2)),_==null||_.__v==null?(c==-1&&(i>u?p--:i<u&&p++),typeof s.type!="function"&&(s.__u|=4)):c!=h&&(c==h-1?p--:c==h+1?p++:(c>h?p--:p++,s.__u|=4))):e.__k[a]=null;if(l)for(a=0;a<u;a++)(_=n[a])!=null&&!(2&_.__u)&&(_.__e==r&&(r=le(_)),Ft(_,_));return r}function Pt(e,t,n){var r,i;if(typeof e.type=="function"){for(r=e.__k,i=0;r&&i<r.length;i++)r[i]&&(r[i].__=e,t=Pt(r[i],t,n));return t}e.__e!=t&&(t&&e.type&&!n.contains(t)&&(t=le(e)),n.insertBefore(e.__e,t||null),t=e.__e);do t=t&&t.nextSibling;while(t!=null&&t.nodeType==8);return t}function ke(e,t){return t=t||[],e==null||typeof e=="boolean"||(me(e)?e.some(function(n){ke(n,t)}):t.push(e)),t}function Ut(e,t,n,r){var i,a,s,_=e.key,h=e.type,c=t[n],u=c!=null&&(2&c.__u)==0;if(c===null&&e.key==null||u&&_==c.key&&h==c.type)return n;if(r>(u?1:0)){for(i=n-1,a=n+1;i>=0||a<t.length;)if((c=t[s=i>=0?i--:a++])!=null&&!(2&c.__u)&&_==c.key&&h==c.type)return s}return-1}function tt(e,t,n){t[0]=="-"?e.setProperty(t,n??""):e[t]=n==null?"":typeof n!="number"||zt.test(t)?n:n+"px"}function ve(e,t,n,r,i){var a,s;e:if(t=="style")if(typeof n=="string")e.style.cssText=n;else{if(typeof r=="string"&&(e.style.cssText=r=""),r)for(t in r)n&&t in n||tt(e.style,t,"");if(n)for(t in n)r&&n[t]==r[t]||tt(e.style,t,n[t])}else if(t[0]=="o"&&t[1]=="n")a=t!=(t=t.replace(kt,"$1")),s=t.toLowerCase(),t=s in e||t=="onFocusOut"||t=="onFocusIn"?s.slice(2):t.slice(2),e.l||(e.l={}),e.l[t+a]=n,n?r?n.u=r.u:(n.u=Le,e.addEventListener(t,a?Ee:Fe,a)):e.removeEventListener(t,a?Ee:Fe,a);else{if(i=="http://www.w3.org/2000/svg")t=t.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(t!="width"&&t!="height"&&t!="href"&&t!="list"&&t!="form"&&t!="tabIndex"&&t!="download"&&t!="rowSpan"&&t!="colSpan"&&t!="role"&&t!="popover"&&t in e)try{e[t]=n??"";break e}catch{}typeof n=="function"||(n==null||n===!1&&t[4]!="-"?e.removeAttribute(t):e.setAttribute(t,t=="popover"&&n==1?"":n))}}function nt(e){return function(t){if(this.l){var n=this.l[t.type+e];if(t.t==null)t.t=Le++;else if(t.t<n.u)return;return n(C.event?C.event(t):t)}}}function Oe(e,t,n,r,i,a,s,_,h,c){var u,l,p,v,N,b,S,g,f,L,D,W,X,j,K,G,V,O=t.type;if(t.constructor!=null)return null;128&n.__u&&(h=!!(32&n.__u),a=[_=t.__e=n.__e]),(u=C.__b)&&u(t);e:if(typeof O=="function")try{if(g=t.props,f="prototype"in O&&O.prototype.render,L=(u=O.contextType)&&r[u.__c],D=u?L?L.props.value:u.__:r,n.__c?S=(l=t.__c=n.__c).__=l.__E:(f?t.__c=l=new O(g,D):(t.__c=l=new Q(g,D),l.constructor=O,l.render=Zt),L&&L.sub(l),l.props=g,l.state||(l.state={}),l.context=D,l.__n=r,p=l.__d=!0,l.__h=[],l._sb=[]),f&&l.__s==null&&(l.__s=l.state),f&&O.getDerivedStateFromProps!=null&&(l.__s==l.state&&(l.__s=J({},l.__s)),J(l.__s,O.getDerivedStateFromProps(g,l.__s))),v=l.props,N=l.state,l.__v=t,p)f&&O.getDerivedStateFromProps==null&&l.componentWillMount!=null&&l.componentWillMount(),f&&l.componentDidMount!=null&&l.__h.push(l.componentDidMount);else{if(f&&O.getDerivedStateFromProps==null&&g!==v&&l.componentWillReceiveProps!=null&&l.componentWillReceiveProps(g,D),!l.__e&&l.shouldComponentUpdate!=null&&l.shouldComponentUpdate(g,l.__s,D)===!1||t.__v==n.__v){for(t.__v!=n.__v&&(l.props=g,l.state=l.__s,l.__d=!1),t.__e=n.__e,t.__k=n.__k,t.__k.some(function(Z){Z&&(Z.__=t)}),W=0;W<l._sb.length;W++)l.__h.push(l._sb[W]);l._sb=[],l.__h.length&&s.push(l);break e}l.componentWillUpdate!=null&&l.componentWillUpdate(g,l.__s,D),f&&l.componentDidUpdate!=null&&l.__h.push(function(){l.componentDidUpdate(v,N,b)})}if(l.context=D,l.props=g,l.__P=e,l.__e=!1,X=C.__r,j=0,f){for(l.state=l.__s,l.__d=!1,X&&X(t),u=l.render(l.props,l.state,l.context),K=0;K<l._sb.length;K++)l.__h.push(l._sb[K]);l._sb=[]}else do l.__d=!1,X&&X(t),u=l.render(l.props,l.state,l.context),l.state=l.__s;while(l.__d&&++j<25);l.state=l.__s,l.getChildContext!=null&&(r=J(J({},r),l.getChildContext())),f&&!p&&l.getSnapshotBeforeUpdate!=null&&(b=l.getSnapshotBeforeUpdate(v,N)),G=u,u!=null&&u.type===ae&&u.key==null&&(G=Rt(u.props.children)),_=St(e,me(G)?G:[G],t,n,r,i,a,s,_,h,c),l.base=t.__e,t.__u&=-161,l.__h.length&&s.push(l),S&&(l.__E=l.__=null)}catch(Z){if(t.__v=null,h||a!=null)if(Z.then){for(t.__u|=h?160:128;_&&_.nodeType==8&&_.nextSibling;)_=_.nextSibling;a[a.indexOf(_)]=null,t.__e=_}else{for(V=a.length;V--;)Ae(a[V]);De(t)}else t.__e=n.__e,t.__k=n.__k,Z.then||De(t);C.__e(Z,t,n)}else a==null&&t.__v==n.__v?(t.__k=n.__k,t.__e=n.__e):_=t.__e=Gt(n.__e,t,n,r,i,a,s,h,c);return(u=C.diffed)&&u(t),128&t.__u?void 0:_}function De(e){e&&e.__c&&(e.__c.__e=!0),e&&e.__k&&e.__k.forEach(De)}function It(e,t,n){for(var r=0;r<n.length;r++)He(n[r],n[++r],n[++r]);C.__c&&C.__c(t,e),e.some(function(i){try{e=i.__h,i.__h=[],e.some(function(a){a.call(i)})}catch(a){C.__e(a,i.__v)}})}function Rt(e){return typeof e!="object"||e==null||e.__b&&e.__b>0?e:me(e)?e.map(Rt):J({},e)}function Gt(e,t,n,r,i,a,s,_,h){var c,u,l,p,v,N,b,S=n.props,g=t.props,f=t.type;if(f=="svg"?i="http://www.w3.org/2000/svg":f=="math"?i="http://www.w3.org/1998/Math/MathML":i||(i="http://www.w3.org/1999/xhtml"),a!=null){for(c=0;c<a.length;c++)if((v=a[c])&&"setAttribute"in v==!!f&&(f?v.localName==f:v.nodeType==3)){e=v,a[c]=null;break}}if(e==null){if(f==null)return document.createTextNode(g);e=document.createElementNS(i,f,g.is&&g),_&&(C.__m&&C.__m(t,a),_=!1),a=null}if(f==null)S===g||_&&e.data==g||(e.data=g);else{if(a=a&&xe.call(e.childNodes),S=n.props||fe,!_&&a!=null)for(S={},c=0;c<e.attributes.length;c++)S[(v=e.attributes[c]).name]=v.value;for(c in S)if(v=S[c],c!="children"){if(c=="dangerouslySetInnerHTML")l=v;else if(!(c in g)){if(c=="value"&&"defaultValue"in g||c=="checked"&&"defaultChecked"in g)continue;ve(e,c,null,v,i)}}for(c in g)v=g[c],c=="children"?p=v:c=="dangerouslySetInnerHTML"?u=v:c=="value"?N=v:c=="checked"?b=v:_&&typeof v!="function"||S[c]===v||ve(e,c,v,S[c],i);if(u)_||l&&(u.__html==l.__html||u.__html==e.innerHTML)||(e.innerHTML=u.__html),t.__k=[];else if(l&&(e.innerHTML=""),St(t.type=="template"?e.content:e,me(p)?p:[p],t,n,r,f=="foreignObject"?"http://www.w3.org/1999/xhtml":i,a,s,a?a[0]:n.__k&&le(n,0),_,h),a!=null)for(c=a.length;c--;)Ae(a[c]);_||(c="value",f=="progress"&&N==null?e.removeAttribute("value"):N!=null&&(N!==e[c]||f=="progress"&&!N||f=="option"&&N!=S[c])&&ve(e,c,N,S[c],i),c="checked",b!=null&&b!=e[c]&&ve(e,c,b,S[c],i))}return e}function He(e,t,n){try{if(typeof e=="function"){var r=typeof e.__u=="function";r&&e.__u(),r&&t==null||(e.__u=e(t))}else e.current=t}catch(i){C.__e(i,n)}}function Ft(e,t,n){var r,i;if(C.unmount&&C.unmount(e),(r=e.ref)&&(r.current&&r.current!=e.__e||He(r,null,t)),(r=e.__c)!=null){if(r.componentWillUnmount)try{r.componentWillUnmount()}catch(a){C.__e(a,t)}r.base=r.__P=null}if(r=e.__k)for(i=0;i<r.length;i++)r[i]&&Ft(r[i],t,n||typeof e.type!="function");n||Ae(e.__e),e.__c=e.__=e.__e=void 0}function Zt(e,t,n){return this.constructor(e,n)}function Vt(e,t,n){var r,i,a,s;t==document&&(t=document.documentElement),C.__&&C.__(e,t),i=(r=!1)?null:t.__k,a=[],s=[],Oe(t,e=t.__k=$e(ae,null,[e]),i||fe,fe,t.namespaceURI,i?null:t.firstChild?xe.call(t.childNodes):null,a,i?i.__e:t.firstChild,r,s),It(a,e,s)}xe=Ct.slice,C={__e:function(e,t,n,r){for(var i,a,s;t=t.__;)if((i=t.__c)&&!i.__)try{if((a=i.constructor)&&a.getDerivedStateFromError!=null&&(i.setState(a.getDerivedStateFromError(e)),s=i.__d),i.componentDidCatch!=null&&(i.componentDidCatch(e,r||{}),s=i.__d),s)return i.__E=i}catch(_){e=_}throw e}},yt=0,Q.prototype.setState=function(e,t){var n;n=this.__s!=null&&this.__s!=this.state?this.__s:this.__s=J({},this.state),typeof e=="function"&&(e=e(J({},n),this.props)),e&&J(n,e),e!=null&&this.__v&&(t&&this._sb.push(t),et(this))},Q.prototype.forceUpdate=function(e){this.__v&&(this.__e=!0,e&&this.__h.push(e),et(this))},Q.prototype.render=ae,oe=[],wt=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,Nt=function(e,t){return e.__v.__b-t.__v.__b},Ne.__r=0,kt=/(PointerCapture)$|Capture$/i,Le=0,Fe=nt(!1),Ee=nt(!0);var qt=0;function o(e,t,n,r,i,a){t||(t={});var s,_,h=t;if("ref"in h)for(_ in h={},t)_=="ref"?s=t[_]:h[_]=t[_];var c={type:e,props:h,key:n,ref:s,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:--qt,__i:-1,__u:0,__source:i,__self:a};if(typeof e=="function"&&(s=e.defaultProps))for(_ in s)h[_]===void 0&&(h[_]=s[_]);return C.vnode&&C.vnode(c),c}var se,M,Ie,rt,ce=0,Et=[],T=C,ot=T.__b,at=T.__r,it=T.diffed,lt=T.__c,st=T.unmount,ct=T.__;function Se(e,t){T.__h&&T.__h(M,e,ce||t),ce=0;var n=M.__H||(M.__H={__:[],__h:[]});return e>=n.__.length&&n.__.push({}),n.__[e]}function I(e){return ce=1,Xt(Mt,e)}function Xt(e,t,n){var r=Se(se++,2);if(r.t=e,!r.__c&&(r.__=[n?n(t):Mt(void 0,t),function(_){var h=r.__N?r.__N[0]:r.__[0],c=r.t(h,_);h!==c&&(r.__N=[c,r.__[1]],r.__c.setState({}))}],r.__c=M,!M.__f)){var i=function(_,h,c){if(!r.__c.__H)return!0;var u=r.__c.__H.__.filter(function(p){return!!p.__c});if(u.every(function(p){return!p.__N}))return!a||a.call(this,_,h,c);var l=r.__c.props!==_;return u.forEach(function(p){if(p.__N){var v=p.__[0];p.__=p.__N,p.__N=void 0,v!==p.__[0]&&(l=!0)}}),a&&a.call(this,_,h,c)||l};M.__f=!0;var a=M.shouldComponentUpdate,s=M.componentWillUpdate;M.componentWillUpdate=function(_,h,c){if(this.__e){var u=a;a=void 0,i(_,h,c),a=u}s&&s.call(this,_,h,c)},M.shouldComponentUpdate=i}return r.__N||r.__}function Ce(e,t){var n=Se(se++,3);!T.__s&&Be(n.__H,t)&&(n.__=e,n.u=t,M.__H.__h.push(n))}function Yt(e,t){var n=Se(se++,4);!T.__s&&Be(n.__H,t)&&(n.__=e,n.u=t,M.__h.push(n))}function _e(e){return ce=5,Dt(function(){return{current:e}},[])}function $t(e,t,n){ce=6,Yt(function(){if(typeof e=="function"){var r=e(t());return function(){e(null),r&&typeof r=="function"&&r()}}if(e)return e.current=t(),function(){return e.current=null}},n==null?n:n.concat(e))}function Dt(e,t){var n=Se(se++,7);return Be(n.__H,t)&&(n.__=e(),n.__H=t,n.__h=e),n.__}function Me(e,t){return ce=8,Dt(function(){return e},t)}function Kt(){for(var e;e=Et.shift();)if(e.__P&&e.__H)try{e.__H.__h.forEach(we),e.__H.__h.forEach(Te),e.__H.__h=[]}catch(t){e.__H.__h=[],T.__e(t,e.__v)}}T.__b=function(e){M=null,ot&&ot(e)},T.__=function(e,t){e&&t.__k&&t.__k.__m&&(e.__m=t.__k.__m),ct&&ct(e,t)},T.__r=function(e){at&&at(e),se=0;var t=(M=e.__c).__H;t&&(Ie===M?(t.__h=[],M.__h=[],t.__.forEach(function(n){n.__N&&(n.__=n.__N),n.u=n.__N=void 0})):(t.__h.forEach(we),t.__h.forEach(Te),t.__h=[],se=0)),Ie=M},T.diffed=function(e){it&&it(e);var t=e.__c;t&&t.__H&&(t.__H.__h.length&&(Et.push(t)!==1&&rt===T.requestAnimationFrame||((rt=T.requestAnimationFrame)||Jt)(Kt)),t.__H.__.forEach(function(n){n.u&&(n.__H=n.u),n.u=void 0})),Ie=M=null},T.__c=function(e,t){t.some(function(n){try{n.__h.forEach(we),n.__h=n.__h.filter(function(r){return!r.__||Te(r)})}catch(r){t.some(function(i){i.__h&&(i.__h=[])}),t=[],T.__e(r,n.__v)}}),lt&&lt(e,t)},T.unmount=function(e){st&&st(e);var t,n=e.__c;n&&n.__H&&(n.__H.__.forEach(function(r){try{we(r)}catch(i){t=i}}),n.__H=void 0,t&&T.__e(t,n.__v))};var _t=typeof requestAnimationFrame=="function";function Jt(e){var t,n=function(){clearTimeout(r),_t&&cancelAnimationFrame(t),setTimeout(e)},r=setTimeout(n,35);_t&&(t=requestAnimationFrame(n))}function we(e){var t=M,n=e.__c;typeof n=="function"&&(e.__c=void 0,n()),M=t}function Te(e){var t=M;e.__c=e.__(),M=t}function Be(e,t){return!e||e.length!==t.length||t.some(function(n,r){return n!==e[r]})}function Mt(e,t){return typeof t=="function"?t(e):t}class pe extends Error{constructor(t,n="UNKNOWN_ERROR",r=null){super(t),this.name="AppError",this.code=n,this.details=r,this.timestamp=new Date().toISOString()}}const Tt={FILE_TOO_LARGE:"FILE_TOO_LARGE",UNSUPPORTED_FORMAT:"UNSUPPORTED_FORMAT"},We=e=>(t,n="")=>{console.error(`[${n}] Error:`,t);let r="An unexpected error occurred.";t instanceof pe?r=t.message:t.name==="QuotaExceededError"?r="Not enough memory available. Try using a smaller image.":t.message.includes("canvas")?r="Canvas operation failed. Please try again.":(t.message.includes("network")||t.message.includes("fetch"))&&(r="Network error. Please check your connection and try again."),e(r)},Qt=(e,t)=>async(...n)=>{try{return await e(...n)}catch(r){throw t(r,e.name),r}},en=(e,t=10*1024*1024)=>{if(e.size>t)throw new pe(`File size too large. Maximum size is ${Math.round(t/(1024*1024))}MB.`,Tt.FILE_TOO_LARGE,{fileSize:e.size,maxSize:t})},tn=e=>{const t=["image/jpeg","image/jpg","image/png","image/gif","image/webp"];if(!t.includes(e.type))throw new pe("Unsupported file format. Please use JPEG, PNG, GIF, or WebP.",Tt.UNSUPPORTED_FORMAT,{fileType:e.type,supportedTypes:t})},nn=(e,t)=>{let n,r=0;return(...i)=>{const a=Date.now();a-r>t?(e(...i),r=a):(clearTimeout(n),n=setTimeout(()=>{e(...i),r=Date.now()},t-(a-r)))}},rn=(e,t)=>{let n;return(...r)=>{clearTimeout(n),n=setTimeout(()=>e(...r),t)}},on=(e,t=4096,n=4096)=>{if(e.width>t||e.height>n)throw new Error(`Image dimensions too large. Maximum size is ${t}x${n}px`);return!0};function an({onImageLoad:e,onError:t}){const[n,r]=I(!1),[i,a]=I(!1),s=_e(),_=We(t),h=Qt(async g=>{try{en(g),tn(g)}catch(f){_(f,"File Validation");return}a(!0);try{const f=await c(g),L=await u(f);on(L),a(!1),e==null||e(L,g)}catch(f){a(!1),_(f,"Image Loading")}},_),c=g=>new Promise((f,L)=>{const D=new FileReader;D.onload=W=>f(W.target.result),D.onerror=()=>L(new pe("Failed to read file. Please try again.")),D.readAsDataURL(g)}),u=g=>new Promise((f,L)=>{const D=new Image;D.onload=()=>f(D),D.onerror=()=>L(new pe("Invalid image file. Please try another file.")),D.src=g});return o("div",{className:"image-upload",children:o("div",{className:`upload-area ${n?"drag-over":""} ${i?"loading":""}`,onDragEnter:g=>{g.preventDefault(),r(!0)},onDragOver:g=>{g.preventDefault()},onDragLeave:g=>{g.preventDefault(),g.currentTarget.contains(g.relatedTarget)||r(!1)},onDrop:g=>{g.preventDefault(),r(!1);const f=Array.from(g.dataTransfer.files);f.length>0&&h(f[0])},onClick:()=>{var g;(g=s.current)==null||g.click()},children:[o("input",{ref:s,type:"file",accept:"image/*",onChange:g=>{const f=Array.from(g.target.files);f.length>0&&h(f[0])},style:{display:"none"}}),i?o("div",{className:"loading-indicator",children:[o("div",{className:"spinner"}),o("p",{children:"Loading image..."})]}):o("div",{className:"upload-content",children:[o("div",{className:"upload-icon",children:"📷"}),o("h3",{children:"Upload an Image"}),o("p",{children:"Drag and drop an image here, or click to select"}),o("p",{className:"supported-formats",children:"Supports: JPEG, PNG, GIF, WebP (max 10MB)"})]})]})})}function ln({tool:e,onToolChange:t,brushSize:n,onBrushSizeChange:r,color:i,onColorChange:a,onUndo:s,onRedo:_,onClear:h,canUndo:c,canRedo:u,tools:l}){const p={brush:"🖌️",pencil:"✏️",eraser:"🧽",fill:"🪣",rectangle:"⬜",ellipse:"⭕",line:"📏",text:"📝"},v={brush:"Brush",pencil:"Pencil",eraser:"Eraser",fill:"Fill",rectangle:"Rectangle",ellipse:"Ellipse",line:"Line",text:"Text"},N=["#000000","#FFFFFF","#FF0000","#00FF00","#0000FF","#FFFF00","#FF00FF","#00FFFF","#FFA500","#800080","#FFC0CB","#A52A2A","#808080","#000080","#008000"];return o("div",{className:"toolbar-sidebar",children:[o("div",{className:"tool-grid",children:Object.entries(l).map(([b,S])=>o("button",{className:`tool-btn ${e===S?"active":""}`,onClick:()=>t(S),title:v[S],children:p[S]},b))}),o("div",{className:"control-section",children:[o("label",{className:"control-label",children:["Size: ",n,"px"]}),o("input",{type:"range",min:"1",max:"50",value:n,onChange:b=>r(parseInt(b.target.value)),className:"size-slider"})]}),o("div",{className:"control-section",children:[o("label",{className:"control-label",children:"Color"}),o("div",{className:"color-section",children:[o("input",{type:"color",value:i,onChange:b=>a(b.target.value),className:"color-picker",title:"Custom color"}),o("div",{className:"color-presets",children:N.map(b=>o("button",{className:`color-preset ${i===b?"active":""}`,style:{backgroundColor:b},onClick:()=>a(b),title:b},b))})]})]}),o("div",{className:"control-section",children:o("div",{className:"action-buttons",children:[o("button",{className:"action-btn",onClick:s,disabled:!c,title:"Undo",children:"↶ Undo"}),o("button",{className:"action-btn",onClick:_,disabled:!u,title:"Redo",children:"↷ Redo"}),o("button",{className:"action-btn clear-btn",onClick:h,title:"Clear canvas",children:"🗑️ Clear"})]})})]})}function Lt(e,t){for(var n in t)e[n]=t[n];return e}function ht(e,t){for(var n in e)if(n!=="__source"&&!(n in t))return!0;for(var r in t)if(r!=="__source"&&e[r]!==t[r])return!0;return!1}function ut(e,t){this.props=e,this.context=t}(ut.prototype=new Q).isPureReactComponent=!0,ut.prototype.shouldComponentUpdate=function(e,t){return ht(this.props,e)||ht(this.state,t)};var dt=C.__b;C.__b=function(e){e.type&&e.type.__f&&e.ref&&(e.props.ref=e.ref,e.ref=null),dt&&dt(e)};var sn=typeof Symbol<"u"&&Symbol.for&&Symbol.for("react.forward_ref")||3911;function At(e){function t(n){var r=Lt({},n);return delete r.ref,e(r,n.ref||null)}return t.$$typeof=sn,t.render=t,t.prototype.isReactComponent=t.__f=!0,t.displayName="ForwardRef("+(e.displayName||e.name)+")",t}var cn=C.__e;C.__e=function(e,t,n,r){if(e.then){for(var i,a=t;a=a.__;)if((i=a.__c)&&i.__c)return t.__e==null&&(t.__e=n.__e,t.__k=n.__k),i.__c(e,t)}cn(e,t,n,r)};var ft=C.unmount;function Ot(e,t,n){return e&&(e.__c&&e.__c.__H&&(e.__c.__H.__.forEach(function(r){typeof r.__c=="function"&&r.__c()}),e.__c.__H=null),(e=Lt({},e)).__c!=null&&(e.__c.__P===n&&(e.__c.__P=t),e.__c.__e=!0,e.__c=null),e.__k=e.__k&&e.__k.map(function(r){return Ot(r,t,n)})),e}function Ht(e,t,n){return e&&n&&(e.__v=null,e.__k=e.__k&&e.__k.map(function(r){return Ht(r,t,n)}),e.__c&&e.__c.__P===t&&(e.__e&&n.appendChild(e.__e),e.__c.__e=!0,e.__c.__P=n)),e}function Re(){this.__u=0,this.o=null,this.__b=null}function Bt(e){var t=e.__.__c;return t&&t.__a&&t.__a(e)}function be(){this.i=null,this.l=null}C.unmount=function(e){var t=e.__c;t&&t.__R&&t.__R(),t&&32&e.__u&&(e.type=null),ft&&ft(e)},(Re.prototype=new Q).__c=function(e,t){var n=t.__c,r=this;r.o==null&&(r.o=[]),r.o.push(n);var i=Bt(r.__v),a=!1,s=function(){a||(a=!0,n.__R=null,i?i(_):_())};n.__R=s;var _=function(){if(!--r.__u){if(r.state.__a){var h=r.state.__a;r.__v.__k[0]=Ht(h,h.__c.__P,h.__c.__O)}var c;for(r.setState({__a:r.__b=null});c=r.o.pop();)c.forceUpdate()}};r.__u++||32&t.__u||r.setState({__a:r.__b=r.__v.__k[0]}),e.then(s,s)},Re.prototype.componentWillUnmount=function(){this.o=[]},Re.prototype.render=function(e,t){if(this.__b){if(this.__v.__k){var n=document.createElement("div"),r=this.__v.__k[0].__c;this.__v.__k[0]=Ot(this.__b,n,r.__O=r.__P)}this.__b=null}var i=t.__a&&$e(ae,null,e.fallback);return i&&(i.__u&=-33),[$e(ae,null,t.__a?null:e.children),i]};var pt=function(e,t,n){if(++n[1]===n[0]&&e.l.delete(t),e.props.revealOrder&&(e.props.revealOrder[0]!=="t"||!e.l.size))for(n=e.i;n;){for(;n.length>3;)n.pop()();if(n[1]<n[0])break;e.i=n=n[2]}};(be.prototype=new Q).__a=function(e){var t=this,n=Bt(t.__v),r=t.l.get(e);return r[0]++,function(i){var a=function(){t.props.revealOrder?(r.push(i),pt(t,e,r)):i()};n?n(a):a()}},be.prototype.render=function(e){this.i=null,this.l=new Map;var t=ke(e.children);e.revealOrder&&e.revealOrder[0]==="b"&&t.reverse();for(var n=t.length;n--;)this.l.set(t[n],this.i=[1,0,this.i]);return e.children},be.prototype.componentDidUpdate=be.prototype.componentDidMount=function(){var e=this;this.l.forEach(function(t,n){pt(e,n,t)})};var _n=typeof Symbol<"u"&&Symbol.for&&Symbol.for("react.element")||60103,hn=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|dominant|fill|flood|font|glyph(?!R)|horiz|image(!S)|letter|lighting|marker(?!H|W|U)|overline|paint|pointer|shape|stop|strikethrough|stroke|text(?!L)|transform|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/,un=/^on(Ani|Tra|Tou|BeforeInp|Compo)/,dn=/[A-Z0-9]/g,fn=typeof document<"u",pn=function(e){return(typeof Symbol<"u"&&typeof Symbol()=="symbol"?/fil|che|rad/:/fil|che|ra/).test(e)};Q.prototype.isReactComponent={},["componentWillMount","componentWillReceiveProps","componentWillUpdate"].forEach(function(e){Object.defineProperty(Q.prototype,e,{configurable:!0,get:function(){return this["UNSAFE_"+e]},set:function(t){Object.defineProperty(this,e,{configurable:!0,writable:!0,value:t})}})});var mt=C.event;function mn(){}function gn(){return this.cancelBubble}function vn(){return this.defaultPrevented}C.event=function(e){return mt&&(e=mt(e)),e.persist=mn,e.isPropagationStopped=gn,e.isDefaultPrevented=vn,e.nativeEvent=e};var bn={enumerable:!1,configurable:!0,get:function(){return this.class}},gt=C.vnode;C.vnode=function(e){typeof e.type=="string"&&function(t){var n=t.props,r=t.type,i={},a=r.indexOf("-")===-1;for(var s in n){var _=n[s];if(!(s==="value"&&"defaultValue"in n&&_==null||fn&&s==="children"&&r==="noscript"||s==="class"||s==="className")){var h=s.toLowerCase();s==="defaultValue"&&"value"in n&&n.value==null?s="value":s==="download"&&_===!0?_="":h==="translate"&&_==="no"?_=!1:h[0]==="o"&&h[1]==="n"?h==="ondoubleclick"?s="ondblclick":h!=="onchange"||r!=="input"&&r!=="textarea"||pn(n.type)?h==="onfocus"?s="onfocusin":h==="onblur"?s="onfocusout":un.test(s)&&(s=h):h=s="oninput":a&&hn.test(s)?s=s.replace(dn,"-$&").toLowerCase():_===null&&(_=void 0),h==="oninput"&&i[s=h]&&(s="oninputCapture"),i[s]=_}}r=="select"&&i.multiple&&Array.isArray(i.value)&&(i.value=ke(n.children).forEach(function(c){c.props.selected=i.value.indexOf(c.props.value)!=-1})),r=="select"&&i.defaultValue!=null&&(i.value=ke(n.children).forEach(function(c){c.props.selected=i.multiple?i.defaultValue.indexOf(c.props.value)!=-1:i.defaultValue==c.props.value})),n.class&&!n.className?(i.class=n.class,Object.defineProperty(i,"className",bn)):(n.className&&!n.class||n.class&&n.className)&&(i.class=i.className=n.className),t.props=i}(e),e.$$typeof=_n,gt&&gt(e)};var vt=C.__r;C.__r=function(e){vt&&vt(e),e.__c};var bt=C.diffed;C.diffed=function(e){bt&&bt(e);var t=e.props,n=e.__e;n!=null&&e.type==="textarea"&&"value"in t&&t.value!==n.value&&(n.value=t.value==null?"":t.value)};const yn=At(function({image:t,onCanvasUpdate:n,onError:r,canvasSize:i={width:800,height:600},tool:a="brush",brushSize:s=5,color:_="#000000",zoom:h=1,onUndoRedoUpdate:c},u){$t(u,()=>({undo:K,redo:G,clearCanvas:te}));const l=_e(),[p,v]=I(!1),[N,b]=I([]),[S,g]=I([]),[f,L]=I(null),[D,W]=I(null),X=We(r);Ce(()=>{if(l.current){const y=l.current,w=y.getContext("2d");t?(y.width=t.width,y.height=t.height,w.clearRect(0,0,y.width,y.height),w.drawImage(t,0,0)):(y.width=i.width,y.height=i.height,w.clearRect(0,0,y.width,y.height),w.fillStyle="#ffffff",w.fillRect(0,0,y.width,y.height)),j()}},[t,i]);const j=()=>{const y=l.current;if(y){const w=y.toDataURL(),$=[...N,w].slice(-20);b($),g([]),n==null||n(y),c==null||c($,[])}},K=()=>{if(N.length>1){const y=l.current,w=y.getContext("2d"),$=N[N.length-1],x=N[N.length-2],E=[...S,$],A=N.slice(0,-1);g(E),b(A),c==null||c(A,E);const B=new window.Image;B.onload=()=>{w.clearRect(0,0,y.width,y.height),w.drawImage(B,0,0),n==null||n(y)},B.src=x}},G=()=>{if(S.length>0){const y=l.current,w=y.getContext("2d"),$=S[S.length-1],x=[...N,$],E=S.slice(0,-1);b(x),g(E),c==null||c(x,E);const A=new window.Image;A.onload=()=>{w.clearRect(0,0,y.width,y.height),w.drawImage(A,0,0),n==null||n(y)},A.src=$}},V=y=>{const $=l.current.getBoundingClientRect();return{x:(y.clientX-$.left)/h,y:(y.clientY-$.top)/h}},O=(y,w,$,x,E)=>{const A=y.getImageData(0,0,y.canvas.width,y.canvas.height),B=A.data,q=[[Math.floor(w),Math.floor($)]],ie=new Set,ne=d=>{const m=B[d],R=B[d+1],P=B[d+2],F=B[d+3];return m===E.r&&R===E.g&&P===E.b&&F===E.a},he=parseInt(x.substr(1,2),16),ue=parseInt(x.substr(3,2),16),de=parseInt(x.substr(5,2),16);for(;q.length>0;){const[d,m]=q.pop(),R=`${d},${m}`;if(ie.has(R)||d<0||d>=y.canvas.width||m<0||m>=y.canvas.height)continue;ie.add(R);const P=(m*y.canvas.width+d)*4;ne(P)&&(B[P]=he,B[P+1]=ue,B[P+2]=de,B[P+3]=255,q.push([d+1,m],[d-1,m],[d,m+1],[d,m-1]))}y.putImageData(A,0,0)},Z=y=>{const w=V(y);v(!0),L(w);const $=l.current,x=$.getContext("2d");if(a==="fill"){const E=x.getImageData(w.x,w.y,1,1),A={r:E.data[0],g:E.data[1],b:E.data[2],a:E.data[3]};O(x,w.x,w.y,_,A),j(),v(!1);return}if(["rectangle","ellipse","line"].includes(a)){const E=document.createElement("canvas");E.width=$.width,E.height=$.height,E.getContext("2d").drawImage($,0,0),W(E);return}x.globalCompositeOperation=a==="eraser"?"destination-out":"source-over",x.strokeStyle=a==="eraser"?"rgba(0,0,0,1)":_,x.lineWidth=s,x.lineCap="round",x.lineJoin="round",a==="pencil"?x.globalAlpha=1:x.globalAlpha=a==="eraser"?1:.8,x.beginPath(),x.moveTo(w.x,w.y)},ee=Me(y=>{if(p)try{const w=V(y),$=l.current,x=$.getContext("2d");if(["rectangle","ellipse","line"].includes(a)){if(x.clearRect(0,0,$.width,$.height),x.drawImage(D,0,0),x.strokeStyle=_,x.lineWidth=s,x.globalCompositeOperation="source-over",a==="rectangle"){const E=w.x-f.x,A=w.y-f.y;x.strokeRect(f.x,f.y,E,A)}else if(a==="ellipse"){const E=Math.abs(w.x-f.x),A=Math.abs(w.y-f.y),B=(f.x+w.x)/2,q=(f.y+w.y)/2;x.beginPath(),x.ellipse(B,q,E,A,0,0,2*Math.PI),x.stroke()}else a==="line"&&(x.beginPath(),x.moveTo(f.x,f.y),x.lineTo(w.x,w.y),x.stroke());return}["brush","pencil","eraser"].includes(a)&&(x.lineTo(w.x,w.y),x.stroke())}catch(w){X(w,"Drawing")}},[p,a,_,s,f,D]),H=Me(nn(ee,16),[ee]),U=()=>{p&&(v(!1),W(null),j())},te=()=>{const y=l.current,w=y.getContext("2d");t?(w.clearRect(0,0,y.width,y.height),w.drawImage(t,0,0)):w.clearRect(0,0,y.width,y.height),j()};return o("div",{className:"paint-canvas",children:o("div",{className:"canvas-container",children:o("div",{className:"canvas-wrapper",children:o("canvas",{ref:l,onMouseDown:Z,onMouseMove:H,onMouseUp:U,onMouseLeave:U,className:"paint-canvas-element",style:{transform:`scale(${h})`,transformOrigin:"top left"}})})})})}),wn=At(({image:e,onCanvasUpdate:t,onError:n,canvasSize:r={width:800,height:600},zoom:i=1,controls:a,setControls:s,onResetFilters:_,onRotateImage:h,onFlipImage:c,onScale:u,onApplyCrop:l,onCancelCrop:p,onUndo:v,onRedo:N,crop:b,setCrop:S,isDragging:g,setIsDragging:f,dragStart:L,setDragStart:D,rotation:W,setRotation:X,scale:j,setScale:K,undoStack:G,setUndoStack:V,redoStack:O,setRedoStack:Z},ee)=>{$t(ee,()=>({flipImage:B,applyCrop:he,undo:ue,redo:de}));const H=_e(),U=_e(),te=We(n);Ce(()=>{if(H.current){const d=H.current,m=d.getContext("2d");e?(d.width=e.width,d.height=e.height,U.current=e,m.clearRect(0,0,d.width,d.height),m.drawImage(e,0,0)):(d.width=r.width,d.height=r.height,m.clearRect(0,0,d.width,d.height),m.fillStyle="#ffffff",m.fillRect(0,0,d.width,d.height),U.current=null),w()}},[e,r]);const y=Me(rn(()=>{try{$()}catch(d){te(d,"Filter Application")}},100),[a,W,j]);Ce(()=>{y()},[a,W,j,y]);const w=()=>{const d=H.current;if(d){const m=d.toDataURL();V(R=>[...R,m].slice(-20)),Z([]),t==null||t(d)}},$=()=>{if(!H.current)return;const d=H.current,m=d.getContext("2d");if(m.clearRect(0,0,d.width,d.height),!U.current){m.fillStyle="#ffffff",m.fillRect(0,0,d.width,d.height);return}if(m.save(),W!==0||j!==1){const P=d.width/2,F=d.height/2;m.translate(P,F),m.rotate(W*Math.PI/180),m.scale(j,j),m.translate(-P,-F)}const R=[`brightness(${a.brightness}%)`,`contrast(${a.contrast}%)`,`saturate(${a.saturation}%)`,`blur(${a.blur}px)`,`hue-rotate(${a.hue}deg)`].join(" ");m.filter=R,m.drawImage(U.current,0,0),m.restore(),m.filter="none"},x=d=>q(d),E=d=>ie(d),A=()=>ne(),B=d=>{const m=H.current;if(m.getContext("2d"),!U.current)return;const R=document.createElement("canvas");R.width=m.width,R.height=m.height;const P=R.getContext("2d");P.save(),d==="horizontal"?(P.translate(R.width,0),P.scale(-1,1)):(P.translate(0,R.height),P.scale(1,-1)),P.drawImage(U.current,0,0),P.restore();const F=new window.Image;F.onload=()=>{U.current=F,$(),w()},F.src=R.toDataURL()},q=d=>{const R=H.current.getBoundingClientRect(),P=(d.clientX-R.left)/i,F=(d.clientY-R.top)/i;f(!0),D({x:P,y:F}),S({x:P,y:F,width:0,height:0,active:!0})},ie=d=>{if(!g)return;const R=H.current.getBoundingClientRect(),P=(d.clientX-R.left)/i,F=(d.clientY-R.top)/i;S(Y=>({...Y,width:P-L.x,height:F-L.y}))},ne=()=>{if(f(!1),Math.abs(b.width)<10||Math.abs(b.height)<10){S(d=>({...d,active:!1}));return}},he=()=>{if(!b.active)return;const d=H.current,m=d.getContext("2d"),R=Math.min(b.x,b.x+b.width),P=Math.min(b.y,b.y+b.height),F=Math.abs(b.width),Y=Math.abs(b.height),Pe=m.getImageData(R,P,F,Y);d.width=F,d.height=Y,m.putImageData(Pe,0,0);const re=new Image;re.onload=()=>{U.current=re,S(ge=>({...ge,active:!1})),w()},re.src=d.toDataURL()},ue=()=>{if(G.length>1){const d=H.current,m=d.getContext("2d"),R=G[G.length-1],P=G[G.length-2];Z(Y=>[...Y,R]),V(Y=>Y.slice(0,-1));const F=new Image;F.onload=()=>{d.width=F.width,d.height=F.height,m.clearRect(0,0,d.width,d.height),m.drawImage(F,0,0),U.current=F,t==null||t(d)},F.src=P}},de=()=>{if(O.length>0){const d=H.current,m=d.getContext("2d"),R=O[O.length-1];V(F=>[...F,R]),Z(F=>F.slice(0,-1));const P=new Image;P.onload=()=>{d.width=P.width,d.height=P.height,m.clearRect(0,0,d.width,d.height),m.drawImage(P,0,0),U.current=P,t==null||t(d)},P.src=R}};return o("div",{className:"photo-editor",children:[!e&&o("div",{className:"no-image-message",children:o("p",{children:"📷 Load an image to use photo editing features"})}),e&&o("div",{className:"canvas-container",children:o("div",{className:"canvas-wrapper",style:{transform:`scale(${i})`,transformOrigin:"top left"},children:[o("canvas",{ref:H,onMouseDown:x,onMouseMove:E,onMouseUp:A,className:"photo-canvas"}),b.active&&o("div",{className:"crop-overlay",style:{left:`${Math.min(b.x,b.x+b.width)}px`,top:`${Math.min(b.y,b.y+b.height)}px`,width:`${Math.abs(b.width)}px`,height:`${Math.abs(b.height)}px`}})]})})]})}),Nn=({controls:e,setControls:t,onResetFilters:n,onRotateImage:r,onFlipImage:i,onScale:a,onApplyCrop:s,onCancelCrop:_,onUndo:h,onRedo:c,crop:u})=>o("div",{className:"photo-controls-panel sidebar-photo-controls",children:[o("div",{className:"filter-controls",children:[o("label",{children:["Brightness",o("input",{type:"range",min:"0",max:"200",value:e.brightness,onInput:l=>t(p=>({...p,brightness:parseInt(l.target.value)}))})]}),o("label",{children:["Contrast",o("input",{type:"range",min:"0",max:"200",value:e.contrast,onInput:l=>t(p=>({...p,contrast:parseInt(l.target.value)}))})]}),o("label",{children:["Saturation",o("input",{type:"range",min:"0",max:"200",value:e.saturation,onInput:l=>t(p=>({...p,saturation:parseInt(l.target.value)}))})]}),o("label",{children:["Blur",o("input",{type:"range",min:"0",max:"20",value:e.blur,onInput:l=>t(p=>({...p,blur:parseInt(l.target.value)}))})]}),o("label",{children:["Hue",o("input",{type:"range",min:"-180",max:"180",value:e.hue,onInput:l=>t(p=>({...p,hue:parseInt(l.target.value)}))})]}),o("button",{onClick:()=>t({brightness:100,contrast:100,saturation:100,blur:0,hue:0}),children:"Reset Filters"})]}),o("div",{className:"transform-controls",children:[o("button",{onClick:()=>r(90),children:"Rotate +90°"}),o("button",{onClick:()=>r(-90),children:"Rotate -90°"}),o("button",{onClick:()=>i("horizontal"),children:"Flip Horizontal"}),o("button",{onClick:()=>i("vertical"),children:"Flip Vertical"}),o("button",{onClick:()=>a("out"),children:"Scale -"}),o("button",{onClick:()=>a("in"),children:"Scale +"})]}),o("div",{className:"crop-controls",children:[o("button",{onClick:s,disabled:!u.active,children:"Apply Crop"}),o("button",{onClick:_,disabled:!u.active,children:"Cancel Crop"})]}),o("div",{className:"history-controls",children:[o("button",{onClick:h,children:"Undo"}),o("button",{onClick:c,children:"Redo"})]})]});function kn({canvas:e,filename:t="paintshop-image"}){const[n,r]=I(!1),[i,a]=I(!1),s=async(h="png",c=1)=>{if(e){r(!0);try{const u=document.createElement("canvas"),l=u.getContext("2d");u.width=e.width,u.height=e.height,h==="jpeg"&&(l.fillStyle="#FFFFFF",l.fillRect(0,0,u.width,u.height)),l.drawImage(e,0,0),u.toBlob(p=>{if(p){const v=URL.createObjectURL(p),N=document.createElement("a");N.href=v,N.download=`${t}.${h}`,document.body.appendChild(N),N.click(),document.body.removeChild(N),URL.revokeObjectURL(v)}r(!1),a(!1)},`image/${h}`,c)}catch(u){console.error("Export failed:",u),r(!1)}}},_=()=>{e&&a(!i)};return e?o("div",{className:"export-container",children:[o("button",{className:"icon-btn",onClick:_,disabled:n,children:[n?o("span",{className:"spinner-small"}):o(ae,{children:"💾"}),o("div",{className:"tooltip",children:"Export Image"})]}),i&&o("div",{className:"export-formats",children:[o("div",{className:"formats-header",children:[o("h3",{children:"Choose Format"}),o("button",{className:"close-btn",onClick:()=>a(!1),children:"✕"})]}),o("div",{className:"format-options",children:[o("button",{className:"format-btn",onClick:()=>s("png"),title:"Best for images with transparency",children:[o("span",{className:"format-icon",children:"🖼️"}),o("div",{className:"format-info",children:[o("strong",{children:"PNG"}),o("small",{children:"Lossless, supports transparency"})]})]}),o("button",{className:"format-btn",onClick:()=>s("jpeg",.9),title:"Smaller file size, good for photos",children:[o("span",{className:"format-icon",children:"📷"}),o("div",{className:"format-info",children:[o("strong",{children:"JPEG"}),o("small",{children:"Smaller size, good for photos"})]})]}),o("button",{className:"format-btn",onClick:()=>s("webp",.9),title:"Modern format, best compression",children:[o("span",{className:"format-icon",children:"🚀"}),o("div",{className:"format-info",children:[o("strong",{children:"WebP"}),o("small",{children:"Modern format, best compression"})]})]})]})]})]}):o("button",{className:"icon-btn",disabled:!0,children:["💾",o("div",{className:"tooltip",children:"No image to export"})]})}function Cn({onCreateCanvas:e,onCancel:t,currentSize:n}){const[r,i]=I(n.width),[a,s]=I(n.height),_=[{name:"Small (400×300)",width:400,height:300},{name:"Medium (800×600)",width:800,height:600},{name:"Large (1200×800)",width:1200,height:800},{name:"HD (1920×1080)",width:1920,height:1080},{name:"Square Small (400×400)",width:400,height:400},{name:"Square Large (800×800)",width:800,height:800},{name:"Portrait (600×800)",width:600,height:800},{name:"Landscape (1000×600)",width:1e3,height:600}],h=u=>{i(u.width),s(u.height)},c=()=>{r>0&&a>0&&r<=4e3&&a<=4e3&&e({width:parseInt(r),height:parseInt(a)})};return o("div",{className:"canvas-settings",children:[o("div",{className:"settings-header",children:[o("h2",{children:"New Canvas"}),o("button",{className:"close-btn",onClick:t,children:"✕"})]}),o("div",{className:"settings-content",children:[o("div",{className:"presets-section",children:[o("h3",{children:"Presets"}),o("div",{className:"presets-grid",children:_.map((u,l)=>o("button",{className:`preset-btn ${r===u.width&&a===u.height?"active":""}`,onClick:()=>h(u),children:u.name},l))})]}),o("div",{className:"custom-section",children:[o("h3",{children:"Custom Size"}),o("div",{className:"size-inputs",children:[o("div",{className:"input-group",children:[o("label",{children:"Width (px)"}),o("input",{type:"number",min:"1",max:"4000",value:r,onChange:u=>i(u.target.value)})]}),o("div",{className:"input-group",children:[o("label",{children:"Height (px)"}),o("input",{type:"number",min:"1",max:"4000",value:a,onChange:u=>s(u.target.value)})]})]}),o("p",{className:"size-info",children:["Canvas size: ",r," × ",a," pixels",(r>2e3||a>2e3)&&o("span",{className:"warning",children:" (Large canvas may affect performance)"})]})]}),o("div",{className:"settings-actions",children:[o("button",{className:"cancel-btn",onClick:t,children:"Cancel"}),o("button",{className:"create-btn",onClick:c,disabled:!r||!a||r<=0||a<=0||r>4e3||a>4e3,children:"Create Canvas"})]})]})]})}function xn({onClose:e}){return o("div",{className:"help-modal",children:o("div",{className:"help-content",children:[o("div",{className:"help-header",children:[o("h2",{children:"PaintShop Help"}),o("button",{className:"close-btn",onClick:e,children:"✕"})]}),o("div",{className:"help-body",children:[o("section",{className:"help-section",children:[o("h3",{children:"Getting Started"}),o("ul",{children:[o("li",{children:"Start drawing immediately on the blank canvas"}),o("li",{children:"Load an image to edit or draw over it"}),o("li",{children:"Switch between Paint and Photo Edit modes"}),o("li",{children:"Export your work when finished"})]})]}),o("section",{className:"help-section",children:[o("h3",{children:"Paint Mode"}),o("ul",{children:[o("li",{children:"Use various tools: brush, pencil, eraser, shapes"}),o("li",{children:"Adjust brush size and color"}),o("li",{children:"Fill areas with the bucket tool"}),o("li",{children:"Undo/redo your actions"})]})]}),o("section",{className:"help-section",children:[o("h3",{children:"Photo Edit Mode"}),o("ul",{children:[o("li",{children:"Adjust brightness, contrast, saturation"}),o("li",{children:"Apply blur and hue rotation effects"}),o("li",{children:"Rotate and scale images"}),o("li",{children:"Crop images by dragging on canvas"})]})]}),o("section",{className:"help-section",children:[o("h3",{children:"Keyboard Shortcuts"}),o("div",{className:"shortcuts-grid",children:[{key:"Ctrl/Cmd + N",action:"New Canvas"},{key:"Ctrl/Cmd + O",action:"Load Image"},{key:"Ctrl/Cmd + S",action:"Export Canvas"},{key:"Ctrl/Cmd + Z",action:"Undo (in canvas)"},{key:"Ctrl/Cmd + Y",action:"Redo (in canvas)"},{key:"Escape",action:"Close modals"},{key:"1-8",action:"Select paint tools"},{key:"[/]",action:"Decrease/Increase brush size"}].map((n,r)=>o("div",{className:"shortcut-item",children:[o("kbd",{children:n.key}),o("span",{children:n.action})]},r))})]})]}),o("div",{className:"help-footer",children:o("button",{className:"close-btn-primary",onClick:e,children:"Got it!"})})]})})}function Sn({tool:e,onToolChange:t,brushSize:n,onBrushSizeChange:r,color:i,onColorChange:a,onUndo:s,onRedo:_,onClear:h,canUndo:c,canRedo:u,tools:l}){return o(ln,{tool:e,onToolChange:t,brushSize:n,onBrushSizeChange:r,color:i,onColorChange:a,onUndo:s,onRedo:_,onClear:h,canUndo:c,canRedo:u,tools:l})}function Pn(){const e=_e(),[t,n]=I(null),[r,i]=I("paint"),[a,s]=I(null),[_,h]=I(null),[c,u]=I(!1),[l,p]=I(!1),[v,N]=I(!1),[b,S]=I({width:800,height:600}),[g,f]=I(!1),[L,D]=I("brush"),[W,X]=I(5),[j,K]=I("#000000"),[G,V]=I([]),[O,Z]=I([]),[ee,H]=I(1),[U,te]=I({brightness:100,contrast:100,saturation:100,blur:0,hue:0}),[y,w]=I({x:0,y:0,width:0,height:0,active:!1}),[$,x]=I(!1),[E,A]=I({x:0,y:0}),[B,q]=I(0),[ie,ne]=I(1),[he,ue]=I([]),[de,d]=I([]),m=_e(),R={brush:"brush",pencil:"pencil",eraser:"eraser",fill:"fill",rectangle:"rectangle",ellipse:"ellipse",line:"line",text:"text"},P=()=>{H(k=>Math.min(k*1.2,5))},F=()=>{H(k=>Math.max(k/1.2,.1))},Y=()=>{H(1)},Pe=(k,z)=>{f(!0),setTimeout(()=>{n(k),h(null),u(!1),S({width:k.width,height:k.height}),f(!1),console.log("Image loaded:",z.name,`${k.width}x${k.height}`)},100)},re=k=>{h(k),setTimeout(()=>h(null),5e3)},ge=k=>{s(k)},ze=k=>{i(k)},Wt=(k=null)=>{f(!0),setTimeout(()=>{n(null),s(null),i("paint"),u(!1),p(!1),k&&S(k),f(!1)},100)},je=()=>{u(!0)},Ue=()=>{p(!0)},Ge=()=>{te({brightness:100,contrast:100,saturation:100,blur:0,hue:0}),q(0),ne(1)},Ze=k=>{q(z=>(z+k+360)%360)},Ve=k=>{m.current&&m.current.flipImage&&m.current.flipImage(k)},qe=k=>{ne(z=>k==="in"?Math.min(z*1.2,5):k==="out"?Math.max(z/1.2,.1):z)},Xe=()=>{m.current&&m.current.applyCrop&&m.current.applyCrop()},Ye=()=>{w(k=>({...k,active:!1}))},Ke=()=>{m.current&&m.current.undo&&m.current.undo()},Je=()=>{m.current&&m.current.redo&&m.current.redo()};return Ce(()=>{const k=z=>{if(z.ctrlKey||z.metaKey)switch(z.key){case"n":z.preventDefault(),Ue();break;case"o":z.preventDefault(),je();break;case"s":z.preventDefault();break}z.key==="Escape"&&(c?u(!1):l?p(!1):v&&N(!1))};return window.addEventListener("keydown",k),()=>window.removeEventListener("keydown",k)},[c,l,v]),o("div",{className:"app",children:[o("header",{className:"app-header",children:o("div",{className:"header-content",children:[o("div",{className:"header-left",children:[o("div",{className:"app-logo",children:"🎨"}),o("div",{className:"header-title",children:[o("h1",{children:"PaintShop"}),o("p",{children:"Paint & Photo Editor"})]})]}),o("div",{className:"header-right",children:[o("button",{className:"icon-btn",onClick:()=>N(!0),children:["❓",o("div",{className:"tooltip",children:"Help & Shortcuts"})]}),o(kn,{canvas:a})]})]})}),_&&o("div",{className:"error-banner",children:[o("span",{children:["⚠️ ",_]}),o("button",{onClick:()=>h(null),className:"error-close",children:"✕"})]}),o("main",{className:"app-main",children:c?o("div",{className:"welcome-screen",children:[o("div",{className:"upload-header",children:o("button",{className:"back-btn",onClick:()=>u(!1),title:"Back to canvas",children:"← Back to Canvas"})}),o(an,{onImageLoad:Pe,onError:re})]}):o("div",{className:"editor-screen",children:[o("div",{className:"editor-sidebar",children:[o("div",{className:"sidebar-section",children:[o("h3",{children:"Mode"}),o("div",{className:"mode-toggle-compact",children:[o("button",{className:`mode-btn-compact ${r==="paint"?"active":""}`,onClick:()=>ze("paint"),children:"🎨 Paint"}),o("button",{className:`mode-btn-compact ${r==="photo"?"active":""}`,onClick:()=>ze("photo"),children:"🖼️ Photo"})]})]}),o("div",{className:"sidebar-section",children:[o("h3",{children:"Actions"}),o("div",{className:"action-buttons",children:[o("button",{className:"action-btn load-image-btn",onClick:je,title:"Load image from file",children:"📁 Load Image"}),o("button",{className:"action-btn new-canvas-btn",onClick:Ue,title:"New blank canvas",children:"📄 New Canvas"})]})]}),o("div",{className:"sidebar-section",children:[o("h3",{children:"View"}),o("div",{className:"zoom-controls",children:[o("div",{className:"zoom-info",children:o("span",{children:["Zoom: ",Math.round(ee*100),"%"]})}),o("div",{className:"zoom-buttons",children:[o("button",{className:"action-btn zoom-btn",onClick:F,title:"Zoom out",children:"🔍- Zoom Out"}),o("button",{className:"action-btn zoom-btn",onClick:Y,title:"Reset zoom",children:"🎯 Reset"}),o("button",{className:"action-btn zoom-btn",onClick:P,title:"Zoom in",children:"🔍+ Zoom In"})]})]})]}),r==="paint"&&o("div",{className:"sidebar-section",children:[o("h3",{children:"Tools"}),o(Sn,{tool:L,onToolChange:D,brushSize:W,onBrushSizeChange:X,color:j,onColorChange:K,onUndo:()=>{var k;return(k=e.current)==null?void 0:k.undo()},onRedo:()=>{var k;return(k=e.current)==null?void 0:k.redo()},onClear:()=>{var k;return(k=e.current)==null?void 0:k.clearCanvas()},canUndo:G.length>1,canRedo:O.length>0,tools:R})]}),r==="photo"&&o("div",{className:"sidebar-section",children:[o("h3",{children:"Adjustments"}),o(Nn,{controls:U,setControls:te,onResetFilters:Ge,onRotateImage:Ze,onFlipImage:Ve,onScale:qe,onApplyCrop:Xe,onCancelCrop:Ye,onUndo:Ke,onRedo:Je,crop:y})]})]}),o("div",{className:"editor-container",children:[r==="paint"?o(yn,{ref:e,image:t,onCanvasUpdate:ge,onError:re,canvasSize:b,tool:L,brushSize:W,color:j,zoom:ee,onUndoRedoUpdate:(k,z)=>{V(k),Z(z)}}):null,r==="photo"&&o(wn,{ref:m,image:t,onCanvasUpdate:ge,onError:re,canvasSize:b,zoom:ee,controls:U,setControls:te,onResetFilters:Ge,onRotateImage:Ze,onFlipImage:Ve,onScale:qe,onApplyCrop:Xe,onCancelCrop:Ye,onUndo:Ke,onRedo:Je,crop:y,setCrop:w,isDragging:$,setIsDragging:x,dragStart:E,setDragStart:A,rotation:B,setRotation:q,scale:ie,setScale:ne,undoStack:he,setUndoStack:ue,redoStack:de,setRedoStack:d})]})]})}),l&&o(Cn,{currentSize:b,onCreateCanvas:Wt,onCancel:()=>p(!1)}),v&&o(xn,{onClose:()=>N(!1)}),g&&o("div",{className:"loading-overlay",children:o("div",{className:"loading-spinner",children:[o("div",{className:"spinner"}),o("p",{children:"Loading..."})]})})]})}Vt(o(Pn,{}),document.getElementById("app"));
